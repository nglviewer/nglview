(self.webpackChunknglview_js_widgets=self.webpackChunknglview_js_widgets||[]).push([[568],{7410:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BaseView=void 0;const widgets=__webpack_require__(7708);var NGL=__webpack_require__(2280);class BaseView extends widgets.DOMWidgetView{render(){this.isEmbeded()||(this.handleMessage(),this.displayed.then((()=>{this.model.set("_ready",!0),this.touch()})))}executeCode(code){eval(code)}handleMessage(){this.model.on("msg:custom",function(e){this.on_msg(e)}.bind(this))}on_msg(e){"callMethod"==e.type&&(console.log("from BaseView",e),this[e.methodName].apply(this,e.args,e.kwargs))}isEmbeded(){return null==this.model.comm}}exports.BaseView=BaseView},587:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColormakerRegistryView=t.ColormakerRegistryModel=void 0;const i=n(8731),s=n(2280),o=n(7410),r=n(7708);class a extends r.DOMWidgetModel{defaults(){return i.extend(r.DOMWidgetModel.prototype.defaults(),{_model_name:"ColormakerRegistryModel",_model_module:"nglview-js-widgets",_model_module_version:n(306).version,_view_name:"ColormakerRegistryView",_view_module:"nglview-js-widgets",_view_module_version:n(306).version})}}t.ColormakerRegistryModel=a;class l extends o.BaseView{render(){super.render(),this.isEmbeded()&&(console.log("Embed mode for ColormakerRegistryView"),this.handleEmbed())}handleEmbed(){this.model.get("_msg_ar").forEach((e=>{this.on_msg(e)}))}addSelectionScheme(e,t){var n=s.ColormakerRegistry.addSelectionScheme(t,e);this._updateId(n,e)}addSelectionSchemeOriginal(e,t){var n=s.ColormakerRegistry.addSelectionScheme(t,e),i=s.ColormakerRegistry.userSchemes[n];s.ColormakerRegistry.removeScheme(n),s.ColormakerRegistry.add(e,i)}addScheme(e,t){var n=Function("return "+t)(),i=s.ColormakerRegistry.addScheme((function(e){this.atomColor=n}));this._updateId(i,e)}_updateId(e,t){var n=s.ColormakerRegistry.userSchemes[e];s.ColormakerRegistry.add(t,n),s.ColormakerRegistry.removeScheme(e)}}t.ColormakerRegistryView=l},9639:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FullscreenView=exports.ABC=exports.FullscreenModel=void 0;const widgets=__webpack_require__(7708),NGL=__webpack_require__(2280),base_1=__webpack_require__(7410);class FullscreenModel extends widgets.DOMWidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:"FullscreenModel",_model_module:"nglview-js-widgets",_model_module_version:__webpack_require__(306).version,_view_name:"FullscreenView",_view_module:"nglview-js-widgets",_view_module_version:__webpack_require__(306).version})}}exports.FullscreenModel=FullscreenModel;class ABC{}exports.ABC=ABC;class FullscreenView extends base_1.BaseView{render(){this.stage=new NGL.Stage;var e=this;this.model.on("msg:custom",(function(t){e.on_msg(t)})),this.handleSignals()}fullscreen(e){var t=this;this.model.widget_manager.get_model(e).then((e=>{var n=Object.keys(e.views)[0];e.views[n].then((e=>{t.stage.toggleFullscreen(e.el)}))}))}handleSignals(){var e=this;this.stage.signals.fullscreenChanged.add((function(t){e.model.set("_is_fullscreen",t),e.touch()}))}executeCode(code){eval(code)}on_msg(e){"executeCode"in e&&this.executeCode(e.executeCode)}}exports.FullscreenView=FullscreenView},3620:(e,t,n)=>{var i,s=n(2280),o=n(7579).UI,r=n(6900);HTMLElement.prototype.getBoundingClientRect=(i=HTMLElement.prototype.getBoundingClientRect,function(){try{return i.apply(this,arguments)}catch(e){return{top:0,left:0,width:this.width,height:this.height}}}),s.Widget=function(){},s.Widget.prototype={constructor:s.Widget},s.createParameterInput=function(e,t){if(e){var n,i=void 0===t?e.value:t;return"number"===e.type?n=new o.Number(0).setRange(e.min,e.max).setPrecision(e.precision).setValue(parseFloat(i)):"integer"===e.type?n=new o.Integer(parseInt(i)).setRange(e.min,e.max):"range"===e.type?n=new o.Range(e.min,e.max,i,e.step).setValue(parseFloat(i)):"boolean"===e.type?n=new o.Checkbox(i):"text"===e.type?n=new o.Input(i):"select"===e.type?n=(new o.Select).setWidth("").setOptions(e.options).setValue(i):"color"===e.type?n=new o.ColorPopupMenu(e.label).setValue(i):"vector3"===e.type?n=new o.Vector3(i).setPrecision(e.precision):"hidden"===e.type||console.warn("NGL.createParameterInput: unknown parameter type '"+e.type+"'"),n}},s.Preferences=function(e,t){this.signals={keyChanged:new r.Signal},this.id=e||"ngl-gui";var n=Object.assign({},t);for(var i in this.storage={impostor:!0,quality:"auto",sampleLevel:0,theme:"dark",backgroundColor:"black",overview:!1,rotateSpeed:2,zoomSpeed:1.2,panSpeed:.8,clipNear:0,clipFar:100,clipDist:10,fogNear:50,fogFar:100,cameraFov:40,cameraType:"perspective",lightColor:14540253,lightIntensity:1,ambientColor:14540253,ambientIntensity:.2,hoverTimeout:0},this.storage)void 0!==n[i]&&(this.storage[i]=n[i])},s.Preferences.prototype={constructor:s.Preferences,getKey:function(e){return this.storage[e]},setKey:function(e,t){this.storage[e]=t,this.signals.keyChanged.dispatch(e,t)}},s.ViewportWidget=function(e){var t=e.viewer,n=(t.renderer,new o.Panel);n.dom=t.container,n.setPosition("absolute");var i=s.flatten([s.ParserRegistry.getStructureExtensions(),s.ParserRegistry.getVolumeExtensions(),s.ParserRegistry.getSurfaceExtensions(),s.DecompressorRegistry.names]);return n.dom.addEventListener("dragover",(function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}),!1),n.dom.addEventListener("drop",(function(t){t.stopPropagation(),t.preventDefault(),new s.Queue((function(t,n){var o=t.name.split(".").pop().toLowerCase();s.ScriptExtensions.includes(o)?e.loadScript(t).then(n):i.includes(o)?e.loadFile(t,{defaultRepresentation:!0}).then(n):(console.error("unknown filetype: "+o),n())}),t.dataTransfer.files)}),!1),n},s.ToolbarWidget=function(e){var t=new o.Panel,n=new o.Text,i=(new o.Panel).setDisplay("inline").setFloat("left").add(n),r=new o.Text,a=(new o.Panel).setDisplay("inline").setFloat("right").add(r);return e.signals.clicked.add((function(e){n.setValue(e?e.getLabel():"nothing")})),e.viewer.stats.signals.updated.add((function(){s.Debug?r.setValue(e.viewer.stats.lastDuration.toFixed(2)+" ms | "+e.viewer.stats.lastFps+" fps"):r.setValue("")})),t.add(i,a),t},s.MenubarWidget=function(e,t){var n=new o.Panel;return n.add(new s.MenubarFileWidget(e)),n.add(new s.MenubarViewWidget(e,t)),s.examplesListUrl&&s.examplesScriptUrl&&n.add(new s.MenubarExamplesWidget(e)),n.add(new s.MenubarHelpWidget(e,t)),n.add((new o.Panel).setClass("menu").setFloat("right").add(new o.Text("NGL Viewer "+s.Version).setClass("title"))),n},s.MenubarFileWidget=function(e){var t=s.flatten([s.ParserRegistry.getStructureExtensions(),s.ParserRegistry.getVolumeExtensions(),s.ParserRegistry.getSurfaceExtensions(),s.DecompressorRegistry.names,s.ScriptExtensions]),n=document.createElement("input");n.type="file",n.multiple=!0,n.style.display="none",n.accept="."+t.join(",."),n.addEventListener("change",(function(n){new s.Queue((function(n,i){var o=n.name.split(".").pop().toLowerCase();s.ScriptExtensions.includes(o)?e.loadScript(n).then(i):t.includes(o)?e.loadFile(n,{defaultRepresentation:!0}).then(i):(console.error("unknown filetype: "+o),i())}),n.target.files)}),!1);var i=new s.ExportImageWidget(e).setDisplay("none").attach(e.viewer.container.parentElement),r=o.MenubarHelper.createOption,a=o.MenubarHelper.createInput,l=o.MenubarHelper.createCheckbox,d=o.MenubarHelper.createDivider,c=[r("Open...",(function(){n.click()})),a("PDB",(function(t){13===t.keyCode&&(e.loadFile("rcsb://"+t.target.value.trim(),{defaultRepresentation:!0}),t.target.value="")})),l("firstModelOnly",!1,(function(t){e.defaultFileParams.firstModelOnly=t.target.checked})),l("cAlphaOnly",!1,(function(t){e.defaultFileParams.cAlphaOnly=t.target.checked})),d(),r("Screenshot",(function(){e.makeImage({factor:1,antialias:!0,trim:!1,transparent:!1}).then((function(e){s.download(e,"screenshot.png")}))}),"camera"),r("Export image...",(function(){i.setOpacity("0.9").setLeft("50px").setTop("80px").setDisplay("block")}))];s.ListingDatasource&&c.splice(1,0,r("Import...",(function(){var n;(n=new s.DirectoryListingWidget(s.ListingDatasource,e,"Import file",t,(function(i){var o=i.path.split(".").pop().toLowerCase();s.ScriptExtensions.includes(o)?(e.loadScript(s.ListingDatasource.getUrl(i.path)),n.dispose()):t.includes(o)?(e.loadFile(s.ListingDatasource.getUrl(i.path),{defaultRepresentation:!0}),n.dispose()):console.error("unknown filetype: "+o)}))).setOpacity("0.9").setLeft("50px").setTop("80px").attach()})));var u=o.MenubarHelper.createOptionsPanel(c);return u.dom.appendChild(n),o.MenubarHelper.createMenuContainer("File",u)},s.MenubarViewWidget=function(e,t){e.signals.fullscreenChanged.add((function(e){var t=s[4].children[0];e?t.switchClass("compress","expand"):t.switchClass("expand","compress")}));var n=o.MenubarHelper.createOption,i=o.MenubarHelper.createDivider,s=[n("Perspective",(function(){e.setParameters({cameraType:"perspective"})})),n("Orthographic",(function(){e.setParameters({cameraType:"orthographic"})})),n("Stereo",(function(){e.setParameters({cameraType:"stereo"})})),i(),n("Full screen",(function(){e.toggleFullscreen(e.viewer.container.parentElement)}),"expand"),n("Center",(function(){e.autoView(1e3)}),"bullseye"),i(),n("Toggle spin",(function(){e.toggleSpin()})),n("Toggle rock",(function(){e.toggleRock()}))],r=o.MenubarHelper.createOptionsPanel(s);return o.MenubarHelper.createMenuContainer("View",r)},s.MenubarExamplesWidget=function(e){var t=o.MenubarHelper.createOption,n=o.MenubarHelper.createOptionsPanel([]);n.setWidth("300px");var i=new XMLHttpRequest;return i.open("GET",s.examplesListUrl),i.responseType="json",i.onload=function(i){var o=this.response;"string"==typeof o&&(o=JSON.parse(o)),o.sort().forEach((function(i){var o=t(i,(function(){e.loadScript(s.examplesScriptUrl+i+".js")}));n.add(o)}))},i.send(),o.MenubarHelper.createMenuContainer("Examples",n)},s.MenubarHelpWidget=function(e,t){function n(){r.setOpacity("0.9").setDisplay("block").setWidgetPosition(50,80)}var i=new s.PreferencesWidget(e,t).setDisplay("none").attach(e.viewer.container.parentElement),r=new s.OverviewWidget(e,t).setDisplay("none").attach(e.viewer.container.parentElement);t.getKey("overview")&&n();var a=o.MenubarHelper.createOption,l=(o.MenubarHelper.createDivider,[a("Overview",n),a("Preferences",(function(){i.setOpacity("0.9").setDisplay("block").setWidgetPosition(50,80)}),"sliders")]),d=o.MenubarHelper.createOptionsPanel(l);return o.MenubarHelper.createMenuContainer("Help",d)},s.OverviewWidget=function(e,t){var n=new o.OverlayPanel,i=0,r=0,a=0,l=0;function d(e){0===a&&(a=e.clientX,l=e.clientY),i-=a-e.clientX,r-=l-e.clientY,a=e.clientX,l=e.clientY,n.dom.style.top=r+"px",n.dom.style.left=i+"px"}n.setWidgetPosition=function(e,t){i=e,r=t,a=0,l=0,n.dom.style.top=r+"px",n.dom.style.left=i+"px"};var c=(new o.Panel).setBorderBottom("1px solid #555").setHeight("25px").setCursor("move").onMouseDown((function(e){1===e.which&&document.addEventListener("mousemove",d),document.addEventListener("mouseup",(function(e){document.removeEventListener("mousemove",d)}))})),u=(new o.Panel).setMarginTop("10px").setMinHeight("100px").setMaxHeight("500px").setMaxWidth("600px").setOverflow("auto");function p(e,t){var n=new o.Panel,i=new o.Icon(e).setWidth("20px").setFloat("left"),s=new o.Text(t).setDisplay("inline").setMarginLeft("5px");n.setMarginLeft("20px").add(i,s),u.add(n)}c.add(new o.Text("NGL Viewer").setFontStyle("italic"),new o.Html("&nbsp;&mdash;&nbsp;Overview")),c.add(new o.Icon("times").setCursor("pointer").setMarginLeft("20px").setFloat("right").onClick((function(){n.setDisplay("none")}))),n.add(c),n.add(u),u.add((new o.Panel).add(new o.Html("To load a new structure use the <i>File</i> menu in the top left via drag'n'drop."))).add(new o.Break),u.add((new o.Panel).add(new o.Text("A number of clickable icons provide common actions. Most icons can be clicked on, just try it or hover the mouse pointer over it to see a tooltip."))).add(new o.Break),p("eye","Controls the visibility of a component."),p("trash-o","Deletes a component. Note that a second click is required to confirm the action."),p("bullseye","Centers a component."),p("bars","Opens a menu with further options."),p("square","Opens a menu with coloring options."),p("filter","Indicates atom-selection input fields."),u.add(new o.Text("Mouse controls")).add(new o.Html("<ul><li>Left button hold and move to rotate camera around center.</li><li>Left button click to pick atom.</li><li>Middle button hold and move to zoom camera in and out.</li><li>Middle button click to center camera on atom.</li><li>Right button hold and move to translate camera in the screen plane.</li></ul>")),u.add((new o.Panel).add(new o.Html("For more information please visit the <a href='"+s.documentationUrl+"' target='_blank'>documentation pages</a>.")));var h=t.getKey("overview"),m=new o.Checkbox(h).onClick((function(){t.setKey("overview",m.getValue())}));return u.add((new o.HorizontalRule).setBorderTop("1px solid #555").setMarginTop("15px")).add((new o.Panel).add(m,new o.Text("Show on startup. Always available from Menu > Help > Overview.").setMarginLeft("5px"))),n},s.PreferencesWidget=function(e,t){var n=new o.OverlayPanel,i=0,r=0,a=0,l=0;function d(e){0===a&&(a=e.clientX,l=e.clientY),i-=a-e.clientX,r-=l-e.clientY,a=e.clientX,l=e.clientY,n.dom.style.top=r+"px",n.dom.style.left=i+"px"}n.setWidgetPosition=function(e,t){i=e,r=t,a=0,l=0,n.dom.style.top=r+"px",n.dom.style.left=i+"px"};var c=(new o.Panel).setBorderBottom("1px solid #555").setHeight("25px").setCursor("move").onMouseDown((function(e){1===e.which&&document.addEventListener("mousemove",d),document.addEventListener("mouseup",(function(e){document.removeEventListener("mousemove",d)}))})),u=(new o.Panel).setMarginTop("10px").setMinHeight("100px").setMaxHeight("500px").setOverflow("auto");return c.add(new o.Text("Preferences")),c.add(new o.Icon("times").setCursor("pointer").setMarginLeft("20px").setFloat("right").onClick((function(){n.setDisplay("none")}))),n.add(c),n.add(u),Object.keys(s.UIStageParameters).forEach((function(n){var i=s.UIStageParameters[n];void 0===i.label&&(i.label=n);var r=s.createParameterInput(i,e.parameters[n]);if(r){t.signals.keyChanged.add((function(e,t){e===n&&r.setValue(t)}));var a=navigator.userAgent;"range"!==i.type||/Trident/.test(a)||/MSIE/.test(a)?r.onChange(l):r.onInput(l),u.add(new o.Text(n).setWidth("120px")).add(r).add(new o.Break)}function l(){var e={};e[n]=r.getValue(),t.setKey(n,e[n])}})),n},s.ExportImageWidget=function(e){var t=new o.OverlayPanel,n=(new o.Panel).setBorderBottom("1px solid #555").setHeight("25px"),i=(new o.Panel).setMarginTop("10px").setMinHeight("100px").setMaxHeight("500px").setOverflow("auto");n.add(new o.Text("Image export")),n.add(new o.Icon("times").setCursor("pointer").setMarginLeft("20px").setFloat("right").onClick((function(){t.setDisplay("none")}))),t.add(n),t.add(i);var r=(new o.Select).setOptions({1:"1x",2:"2x",3:"3x",4:"4x",5:"5x",6:"6x",7:"7x",8:"8x",9:"9x",10:"10x"}).setValue("4"),a=(new o.Checkbox).setValue(!0),l=(new o.Checkbox).setValue(!1),d=(new o.Checkbox).setValue(!1),c=(new o.Progress).setDisplay("none"),u=new o.Button("export").onClick((function(){function t(e,t,n){1===e&&c.setMax(t),e>=t?c.setIndeterminate():c.setValue(e),n&&(c.setDisplay("none"),u.setDisplay("inline-block"))}u.setDisplay("none"),c.setDisplay("inline-block"),setTimeout((function(){e.makeImage({factor:parseInt(r.getValue()),antialias:a.getValue(),trim:l.getValue(),transparent:d.getValue(),onProgress:t}).then((function(e){s.download(e,"screenshot.png")}))}),50)}));function p(e,t){i.add(new o.Text(e).setWidth("80px")).add(t||new o.Panel).add(new o.Break)}return p("scale",r),p("antialias",a),p("trim",l),p("transparent",d),i.add(new o.Break,u,c),t},s.SidebarWidget=function(e,t){var n=e.signals,i=new o.Panel;i.view=t;var r=(new o.Panel).setClass("Content"),a=[],l=[];function d(t){var n;switch(t.type){case"structure":n=new s.StructureComponentWidget(t,e);break;case"surface":n=new s.SurfaceComponentWidget(t,e);break;case"volume":n=new s.VolumeComponentWidget(t,e);break;case"shape":n=new s.ShapeComponentWidget(t,e);break;default:return void console.warn("NGL.SidebarWidget: component type unknown",t)}r.add(n),a.push(t),l.push(n)}e.compList.forEach((function(e){d(e)})),n.componentAdded.add(d),n.componentRemoved.add((function(e){var t=a.indexOf(e);-1!==t&&(l[t].dispose(),a.splice(t,1),l.splice(t,1))}));var c=new o.Icon("plus-square").setTitle("expand all").setCursor("pointer").onClick((function(){l.forEach((function(e){e.expand()}))})),u=new o.Icon("minus-square").setTitle("collapse all").setCursor("pointer").setMarginLeft("10px").onClick((function(){l.forEach((function(e){e.collapse()}))})),p=new o.Icon("bullseye").setTitle("center all").setCursor("pointer").setMarginLeft("10px").onClick((function(){e.autoView(1e3)})),h=(new o.DisposeIcon).setMarginLeft("10px").setDisposeFunction((function(){e.removeAllComponents()})),m=new o.Icon("superpowers").setTitle("sync representation").setCursor("pointer").setMarginLeft("10px").onClick((function(){t&&t.syncReprWithMe()})),g=new o.PopupMenu("cogs","Settings","window").setIconTitle("settings").setMarginLeft("10px");g.entryLabelWidth="120px";var f=(new o.Panel).setDisplay("inline").add(new o.Icon("spinner").addClass("spin").setMarginLeft("45px"));e.tasks.signals.countChanged.add((function(e,t){if(t>0)v.add(f);else try{v.remove(f)}catch(e){}})),["clipNear","clipFar","clipDist","fogNear","fogFar","lightColor","lightIntensity","ambientColor","ambientIntensity"].forEach((function(t){var n=s.UIStageParameters[t];void 0===n.label&&(n.label=t);var i=s.createParameterInput(n,e.parameters[t]);if(i){e.signals.parametersChanged.add((function(e){i.setValue(e[t])}));var o=navigator.userAgent;"range"!==n.type||/Trident/.test(o)||/MSIE/.test(o)?i.onChange(r):i.onInput(r),g.addEntry(t,i)}function r(){var n={};n[t]=i.getValue(),e.setParameters(n)}}));var v=(new o.Panel).setClass("Panel Sticky").add(c,u,p,h,m,g);return i.add(v,r),i},s.StructureComponentWidget=function(e,t){var n=e.signals,i=new o.CollapsibleIconPanel("minus-square","plus-square"),r=new o.Panel,a=new o.Panel;function l(n){r.add(new s.RepresentationElementWidget(n,t,e))}e.reprList.forEach((function(e){l(e)})),n.representationAdded.add(l),n.trajectoryAdded.add((function(e){a.add(new s.TrajectoryElementWidget(e,t))})),n.defaultAssemblyChanged.add((function(){m.setValue(e.parameters.defaultAssembly)})),i.add(new o.SelectionPanel(e.selection).setMarginLeft("20px").setInputWidth("214px"));var d,c,u,p=new o.Button("export").onClick((function(){new s.PdbWriter(e.structure).download("structure"),F.setMenuDisplay("none")})),h=(new o.Select).setColor("#444").setOptions((d={"":"[ add ]"},s.RepresentationRegistry.names.forEach((function(e){d[e]=e})),d)).onChange((function(){e.addRepresentation(h.getValue()),h.setValue(""),F.setMenuDisplay("none")})),m=(new o.Select).setColor("#444").setOptions((c=e.structure.biomolDict,u={"":e.structure.unitcell?"AU":"FULL"},Object.keys(c).forEach((function(e){u[e]=e})),u)).setValue(e.parameters.defaultAssembly).onChange((function(){e.setDefaultAssembly(m.getValue()),F.setMenuDisplay("none")})),g=[];s.ParserRegistry.getTrajectoryExtensions().forEach((function(e){g.push("."+e,"."+e+".gz")}));var f=document.createElement("input");f.type="file",f.multiple=!0,f.style.display="none",f.accept=g.join(","),f.addEventListener("change",(function(t){new s.Queue((function(t,n){s.autoLoad(t).then((function(t){e.addTrajectory(t),n()}))}),t.target.files),t.target.value=""}),!1);var v=new o.Button("open").onClick((function(){f.click(),F.setMenuDisplay("none")})),y=new o.Button("import").onClick((function(){F.setMenuDisplay("none");var n,i=["xtc","trr","netcdf","dcd","ncdf","nc","gro","pdb","lammpstrj","xyz","mdcrd","gz","binpos","h5","dtr","arc","tng","trj","trz"];(n=new s.DirectoryListingWidget(s.ListingDatasource,t,"Import trajectory",i,(function(t){var o=t.path.split(".").pop().toLowerCase();-1!==i.indexOf(o)?(e.addTrajectory(t.path+"?struc="+e.structure.path),n.dispose()):s.log("unknown trajectory type: "+o)}))).setOpacity("0.9").setLeft("50px").setTop("80px").attach()}));function w(){var n={"":"[ structure ]"};t.eachComponent((function(t,i){t!==e&&(n[i]=t.name)}),s.StructureComponent),_.setOptions(n)}t.signals.componentAdded.add(w),t.signals.componentRemoved.add(w);var _=(new o.Select).setColor("#444").onChange((function(){e.superpose(t.compList[_.getValue()],!0),e.autoView(1e3),_.setValue(""),F.setMenuDisplay("none")}));w();var x=new o.Button("align").onClick((function(){var n=e.structure.getPrincipalAxes().getRotationQuaternion();n.multiply(e.quaternion.clone().inverse()),t.animationControls.rotate(n),t.animationControls.move(e.getCenter())})),b=new o.Button("remove").onClick((function(){e.removeAllMeasurements()})),C=new o.Button("show").onClick((function(){e.annotationList.forEach((function(e){e.setVisibility(!0)}))})),E=new o.Button("hide").onClick((function(){e.annotationList.forEach((function(e){e.setVisibility(!1)}))})),k=(new o.Panel).setDisplay("inline-block").add(C,E),P=document.createElement("input");P.type="file",P.style.display="none",P.accept=".xml",P.addEventListener("change",(function(t){new s.Queue((function(t,n){s.autoLoad(t,{ext:"validation"}).then((function(t){e.structure.validation=t,n()}))}),t.target.files)}),!1);var M=new o.Button("open").onClick((function(){P.click(),F.setMenuDisplay("none")})),L=(new o.Vector3).onChange((function(){e.setPosition(L.getValue())})),V=new s.Quaternion,I=new s.Euler,T=(new o.Vector3).setRange(-6.28,6.28).onChange((function(){I.setFromVector3(T.getValue()),V.setFromEuler(I),e.setRotation(V)})),S=new o.Number(1).setRange(.01,100).onChange((function(){e.setScale(S.getValue())}));n.matrixChanged.add((function(){L.setValue(e.position),T.setValue(I.setFromQuaternion(e.quaternion)),S.setValue(e.scale.x)}));var F=new o.ComponentPanel(e).setDisplay("inline-block").setMargin("0px").addMenuEntry("PDB file",p).addMenuEntry("Representation",h).addMenuEntry("Assembly",m).addMenuEntry("Superpose",_).addMenuEntry("File",new o.Text(e.structure.path).setMaxWidth("100px").setOverflow("auto")).addMenuEntry("Trajectory",v).addMenuEntry("Principal axes",x).addMenuEntry("Measurements",b).addMenuEntry("Annotations",k).addMenuEntry("Validation",M).addMenuEntry("Position",L).addMenuEntry("Rotation",T).addMenuEntry("Scale",S);return s.ListingDatasource&&s.TrajectoryDatasource&&F.addMenuEntry("Remote trajectory",y),i.addStatic(F).add(a).add(r),i},s.SurfaceComponentWidget=function(e,t){var n=e.signals,i=new o.CollapsibleIconPanel("minus-square","plus-square"),r=new o.Panel;n.representationAdded.add((function(e){r.add(new s.RepresentationElementWidget(e,t))}));var a=(new o.Select).setColor("#444").setOptions({"":"[ add ]",surface:"surface",dot:"dot"}).onChange((function(){e.addRepresentation(a.getValue()),a.setValue(""),h.setMenuDisplay("none")})),l=(new o.Vector3).onChange((function(){e.setPosition(l.getValue())})),d=new s.Quaternion,c=new s.Euler,u=(new o.Vector3).setRange(-6.28,6.28).onChange((function(){c.setFromVector3(u.getValue()),d.setFromEuler(c),e.setRotation(d)})),p=new o.Number(1).setRange(.01,100).onChange((function(){e.setScale(p.getValue())}));n.matrixChanged.add((function(){l.setValue(e.position),u.setValue(c.setFromQuaternion(e.quaternion)),p.setValue(e.scale.x)}));var h=new o.ComponentPanel(e).setDisplay("inline-block").setMargin("0px").addMenuEntry("Representation",a).addMenuEntry("File",new o.Text(e.surface.path).setMaxWidth("100px").setWordWrap("break-word")).addMenuEntry("Position",l).addMenuEntry("Rotation",u).addMenuEntry("Scale",p);return i.addStatic(h).add(r),i},s.VolumeComponentWidget=function(e,t){var n=e.signals,i=new o.CollapsibleIconPanel("minus-square","plus-square"),r=new o.Panel;n.representationAdded.add((function(e){r.add(new s.RepresentationElementWidget(e,t))}));var a=(new o.Select).setColor("#444").setOptions({"":"[ add ]",surface:"surface",dot:"dot",slice:"slice"}).onChange((function(){e.addRepresentation(a.getValue()),a.setValue(""),h.setMenuDisplay("none")})),l=(new o.Vector3).onChange((function(){e.setPosition(l.getValue())})),d=new s.Quaternion,c=new s.Euler,u=(new o.Vector3).setRange(-6.28,6.28).onChange((function(){c.setFromVector3(u.getValue()),d.setFromEuler(c),e.setRotation(d)})),p=new o.Number(1).setRange(.01,100).onChange((function(){e.setScale(p.getValue())}));n.matrixChanged.add((function(){l.setValue(e.position),u.setValue(c.setFromQuaternion(e.quaternion)),p.setValue(e.scale.x)}));var h=new o.ComponentPanel(e).setDisplay("inline-block").setMargin("0px").addMenuEntry("Representation",a).addMenuEntry("File",new o.Text(e.volume.path).setMaxWidth("100px").setWordWrap("break-word")).addMenuEntry("Position",l).addMenuEntry("Rotation",u).addMenuEntry("Scale",p);return i.addStatic(h).add(r),i},s.ShapeComponentWidget=function(e,t){var n=e.signals,i=new o.CollapsibleIconPanel("minus-square","plus-square"),r=new o.Panel;n.representationAdded.add((function(e){r.add(new s.RepresentationElementWidget(e,t))}));var a=(new o.Select).setColor("#444").setOptions({"":"[ add ]",buffer:"buffer"}).onChange((function(){e.addRepresentation(a.getValue()),a.setValue(""),h.setMenuDisplay("none")})),l=(new o.Vector3).onChange((function(){e.setPosition(l.getValue())})),d=new s.Quaternion,c=new s.Euler,u=(new o.Vector3).setRange(-6.28,6.28).onChange((function(){c.setFromVector3(u.getValue()),d.setFromEuler(c),e.setRotation(d)})),p=new o.Number(1).setRange(.01,100).onChange((function(){e.setScale(p.getValue())}));n.matrixChanged.add((function(){l.setValue(e.position),u.setValue(c.setFromQuaternion(e.quaternion)),p.setValue(e.scale.x)}));var h=new o.ComponentPanel(e).setDisplay("inline-block").setMargin("0px").addMenuEntry("Representation",a).addMenuEntry("File",new o.Text(e.shape.path).setMaxWidth("100px").setWordWrap("break-word")).addMenuEntry("Position",l).addMenuEntry("Rotation",u).addMenuEntry("Scale",p);return i.addStatic(h).add(r),i},s.RepresentationElementWidget=function(e,t,n){var i=e.signals,r=new o.CollapsibleIconPanel("minus-square","plus-square").setMarginLeft("20px");i.visibilityChanged.add((function(e){l.setValue(e)})),i.nameChanged.add((function(e){a.setValue(e)})),i.disposed.add((function(){u.dispose(),r.dispose()}));var a=new o.EllipsisText(e.name).setWidth("103px"),l=new o.ToggleIcon(e.visible,"eye","eye-slash").setTitle("hide/show").setCursor("pointer").setMarginLeft("25px").onClick((function(){e.setVisibility(!e.visible)})),d=new o.Icon("bullseye").setTitle("center").setCursor("pointer").setMarginLeft("10px").onClick((function(){n.autoView(e.repr.selection.string,1e3)})),c=(new o.DisposeIcon).setMarginLeft("10px").setDisposeFunction((function(){e.dispose()}));n?r.addStatic(a).addStatic(l).addStatic(d).addStatic(c):r.addStatic(a).addStatic(l).addStatic(c),"structure"!==e.parent.type&&"trajectory"!==e.parent.type||!e.repr.selection||"selection"!==e.repr.selection.type||r.add(new o.SelectionPanel(e.repr.selection).setMarginLeft("20px").setInputWidth("194px"));var u=new o.PopupMenu("bars","Representation").setMarginLeft("45px").setEntryLabelWidth("190px");u.addEntry("type",new o.Text(e.repr.type));var p=e.repr,h=p.getParameters();return Object.keys(p.parameters).forEach((function(n){if(p.parameters[n]){var o=Object.assign({},p.parameters[n]);o.value=h[n],void 0===o.label&&(o.label=n);var r=s.createParameterInput(o);if(r){i.parametersChanged.add((function(e){"function"==typeof r.setValue&&r.setValue(e[n])}));var a=navigator.userAgent;"range"!==o.type||/Trident/.test(a)||/MSIE/.test(a)?r.onChange(l):r.onInput(l),u.addEntry(n,r)}}function l(){var i={};i[n]=r.getValue(),e.setParameters(i),t.viewer.requestRender()}})),r.addStatic(u),r},s.TrajectoryElementWidget=function(e,t){var n=e.signals,i=e.trajectory,r=new o.CollapsibleIconPanel("minus-square","plus-square").setMarginLeft("20px");n.disposed.add((function(){T.dispose(),r.dispose()}));var a=(new o.Panel).setDisplay("inline").add(new o.Icon("spinner").addClass("spin").setMarginRight("99px")),l=(new o.Panel).setMarginLeft("5px").setDisplay("inline");function d(e){if(p.setValue(e),i.deltaTime&&e>=0){var t=i.getFrameTime(e)/1e3;h.setValue(t.toFixed(9).replace(/\.?0+$/g,"")+"ns")}else h.setValue("");f.setValue(e),a.clear().add(p.setWidth("40px")),l.clear().add(h.setWidth("90px"))}function c(t){p.setRange(-1,t-1),f.setRange(-1,t-1),d(i.currentFrame),void 0!==e.parameters.defaultStep?m.setValue(e.parameters.defaultStep):m.setValue(Math.ceil((t+1)/100)),b.setParameters({step:m.getValue()}),b.setParameters({end:t-1})}n.countChanged.add(c),n.frameChanged.add(d);var u=new o.EllipsisText(e.parameters.name).setWidth("103px");n.nameChanged.add((function(e){u.setValue(e)})),r.addStatic(u),r.addStatic(l);var p=new o.Integer(-1).setWidth("40px").setTextAlign("right").setMarginLeft("5px").setRange(-1,-1).onChange((function(e){i.setFrame(p.getValue()),T.setMenuDisplay("none")})),h=(new o.Text).setTextAlign("right").setWidth("90px"),m=new o.Integer(1).setWidth("50px").setRange(1,1e4).onChange((function(){b.setParameters({step:m.getValue()})})),g=new o.Panel,f=new o.Range(-1,-1,-1,1).setWidth("147px").setMargin("0px").setPadding("0px").setBorder("0px").onInput((function(e){var t=f.getValue();t!==i.currentFrame&&(i.player&&i.player.isRunning?(i.setPlayer(),i.setFrame(t)):i.inProgress||i.setFrame(t))})),v=(new o.Select).setColor("#444").setOptions({"":"none",linear:"linear",spline:"spline"}).setValue(e.parameters.defaultInterpolateType).onChange((function(){b.setParameters({interpolateType:v.getValue()})})),y=new o.Integer(e.parameters.defaultInterpolateStep).setWidth("30px").setRange(1,50).onChange((function(){b.setParameters({interpolateStep:y.getValue()})})),w=(new o.Select).setColor("#444").setOptions({forward:"forward",backward:"backward",bounce:"bounce"}).setValue(e.parameters.defaultDirection).onChange((function(){b.setParameters({direction:w.getValue()})})),_=(new o.Select).setColor("#444").setOptions({loop:"loop",once:"once"}).setValue(e.parameters.defaultMode).onChange((function(){b.setParameters({mode:_.getValue()})})),x=new o.Integer(e.parameters.defaultTimeout).setWidth("30px").setRange(10,1e3).onChange((function(){b.setParameters({timeout:x.getValue()})})),b=new s.TrajectoryPlayer(i,{step:m.getValue(),timeout:x.getValue(),start:0,end:i.frameCount-1,interpolateType:v.getValue(),interpolateStep:y.getValue(),direction:w.getValue(),mode:_.getValue()});i.setPlayer(b);var C=new o.ToggleIcon(!0,"play","pause").setMarginRight("10px").setMarginLeft("20px").setCursor("pointer").setWidth("12px").setTitle("play").onClick((function(){b.toggle()}));b.signals.startedRunning.add((function(){C.setTitle("pause").setValue(!1)})),b.signals.haltedRunning.add((function(){C.setTitle("play").setValue(!0)})),g.add(C,f,a),r.add(new o.SelectionPanel(i.selection).setMarginLeft("20px").setInputWidth("194px"));var E=new o.Checkbox(i.centerPbc).onChange((function(){e.setParameters({centerPbc:E.getValue()})})),k=new o.Checkbox(i.removePeriodicity).onChange((function(){e.setParameters({removePeriodicity:k.getValue()})})),P=new o.Checkbox(i.removePbc).onChange((function(){e.setParameters({removePbc:P.getValue()})})),M=new o.Checkbox(i.superpose).onChange((function(){e.setParameters({superpose:M.getValue()})})),L=new o.Number(i.deltaTime).setWidth("55px").setRange(0,1e6).onChange((function(){e.setParameters({deltaTime:L.getValue()})})),V=new o.Number(i.timeOffset).setWidth("55px").setRange(0,1e9).onChange((function(){e.setParameters({timeOffset:V.getValue()})}));n.parametersChanged.add((function(e){E.setValue(i.centerPbc),k.setValue(i.removePeriodicity),P.setValue(i.removePbc),M.setValue(i.superpose),L.setValue(i.deltaTime),V.setValue(i.timeOffset),i.setFrame(p.getValue())}));var I=(new o.DisposeIcon).setDisposeFunction((function(){e.parent.removeTrajectory(e)}));i.frameCount&&c(i.frameCount);var T=new o.PopupMenu("bars","Trajectory").setMarginLeft("10px").setEntryLabelWidth("130px").addEntry("Center",E).addEntry("Remove Periodicity",k).addEntry("Remove PBC",P).addEntry("Superpose",M).addEntry("Step size",m).addEntry("Interpolation type",v).addEntry("Interpolation steps",y).addEntry("Play timeout",x).addEntry("Play direction",w).addEntry("Play mode",_).addEntry("Delta time [ps]",L).addEntry("Time offset [ps]",V).addEntry("File",new o.Text(i.trajPath).setMaxWidth("100px").setWordWrap("break-word")).addEntry("Dispose",I);return r.addStatic(T),r.add(g),r},s.DirectoryListingWidget=function(e,t,n,i,r){function a(e){var t={"":""},n=[];return(e=e||"").split("/").forEach((function(e){n.push(e),t[n.join("/")]=e})),t}var l=new o.OverlayPanel,d=(new o.Panel).setBorderBottom("1px solid #555").setHeight("30px"),c=(new o.Panel).setMarginTop("10px").setMinHeight("100px").setMaxHeight("500px").setPaddingRight("15px").setOverflow("auto"),u=(new o.Select).setColor("#444").setMarginLeft("20px").setWidth("").setMaxWidth("200px").setOptions(a()).onChange((function(){e.getListing(u.getValue()).then(p)}));function p(t){var n=t.path,l=t.data;s.lastUsedDirectory=n,c.clear(),u.setOptions(a(n)).setValue(n),l.forEach((function(t){var n=t.path.split(".").pop().toLowerCase();if(!i||t.dir||-1!==i.indexOf(n)){var s,a,l,d,u,h;t.dir?(s="folder-o",a=t.name):(s="file-o",a=t.name+String.fromCharCode(160)+"("+(l=t.size,(d=Math,u=d.log,h=u(l)/u(1e3)|0,l/d.pow(1e3,h)).toFixed(2)+String.fromCharCode(160)+(h?"kMGTPEZY"[--h]+"B":"Bytes")+")"));var m=(new o.Panel).setDisplay("block").setWhiteSpace("nowrap").add(new o.Icon(s).setWidth("20px")).add(new o.Text(a)).onClick((function(){t.dir?e.getListing(t.path).then(p):r(t)}));t.restricted&&m.add(new o.Icon("lock").setMarginLeft("5px")),c.add(m)}}))}return n=n||"Directoy listing",d.add(new o.Text(n)),d.add(u),d.add(new o.Icon("times").setCursor("pointer").setMarginLeft("20px").setFloat("right").onClick((function(){l.dispose()}))),l.add(d),l.add(c),e.getListing(s.lastUsedDirectory).then(p),l},e.exports={StageWidget:class{constructor(e){var t,n=e.stage,i=new o.Panel;t=e.options.parent?e.el.parentElement:e.el,i.setPosition("absolute"),i.dom=n.viewer.container,this.el=t,this.widgetList=[];var r=new s.Preferences("ngl-stage-widget",n.getParameters()),a={};for(var l in r.storage)a[l]=r.getKey(l);n.setParameters(a),r.signals.keyChanged.add((function(e,t){var i={};i[e]=t,n.setParameters(i)}),this);var d=document.createElement("link");d.rel="stylesheet",d.id="theme",t.appendChild(d);var c=new s.ToolbarWidget(n).setId("toolbar_ngl");t.appendChild(c.dom);var u=new s.MenubarWidget(n,r).setId("menubar_ngl");t.appendChild(u.dom);var p=new s.SidebarWidget(n).setId("sidebar_ngl");t.appendChild(p.dom),this.widgetList.push(c),this.widgetList.push(u),this.widgetList.push(p),t.style.touchAction="none",n.handleResize(),setTimeout((function(){n.handleResize()}),500);var h=!1,m=!1,g=!1,f=function(e){e>=50&&e<=window.innerWidth-10&&(p.setWidth(window.innerWidth-e+"px"),i.setWidth(e+"px"),c.setWidth(e+"px"),n.handleResize());var t=p.dom.getBoundingClientRect().width;if(void 0===e){var s=window.innerWidth-t;i.setWidth(s+"px"),c.setWidth(s+"px"),n.handleResize()}g=t<=10,v()};f=s.throttle(f,50,{leading:!0,trailing:!0});var v=function(){var e=p.dom.getBoundingClientRect().width,i=t.getBoundingClientRect().width;i==e&&(e=i/4);var s=i-e+"px";n.viewer.container.style.width=s,n.handleResize()},y=(new o.Panel).setClass("ResizeLeft").onMouseDown((function(){h=!0,m=!1})).onClick((function(){g?f(window.innerWidth-300):h||m||f(window.innerWidth-10)}));p.add(y),this.viewport=i,this.toolbar=c,this.menubar=u,this.sidebar=p,v(),n.signals.fullscreenChanged.add((function(t){const i=n.viewer.container.parentElement.getBoundingClientRect();n.setSize(i.width+"px",t?i.height+"px":"300px"),e.handleResize()})),window.addEventListener("mousemove",(function(e){h&&(document.body.style.cursor="col-resize",m=!0,f(e.clientX))}),!1),window.addEventListener("mouseup",(function(e){h=!1,document.body.style.cursor=""}),!1),window.addEventListener("resize",(function(e){f()}),!1),document.addEventListener("dragover",(function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="none"}),!1),document.addEventListener("drop",(function(e){e.stopPropagation(),e.preventDefault()}),!1)}dispose(){for(var e in this.widgetList)this.widgetList[e].dispose()}}}},1568:(e,t,n)=>{e.exports={};var i=[n(7387)];for(var s in i)if(i&&Object.prototype.hasOwnProperty.call(i,s)){var o=i[s];for(var r in o)o&&Object.prototype.hasOwnProperty.call(o,r)&&(e.exports[r]=o[r])}e.exports.version=n(306).version},5435:()=>{"function"!=typeof importScripts&&function(e,t,n){function i(e,t){var n=t.getBoundingClientRect();return{x:Math.max(Math.min(e.clientX-n.left,t.clientWidth),0),y:Math.max(Math.min(e.clientY-n.top,t.clientHeight),0)}}function s(e,n,i){for(var s in e=t.createElementNS("http://www.w3.org/2000/svg",e),n)e.setAttribute(s,n[s]);for(Array.isArray(i)||(i=[i]),n=0,s=i[0]&&i.length||0;n<s;n++)e.appendChild(i[n]);return e}function o(e){var t,n,i,s,o=e.h%360/60;return i=(s=e.v*e.s)*(1-Math.abs(o%2-1)),t=n=e=e.v-s,t+=[s,i,0,0,i,s][o=~~o],n+=[i,s,s,i,0,0][o],e+=[0,0,i,s,s,i][o],{r:i=Math.floor(255*t),g:n=Math.floor(255*n),b:e=Math.floor(255*e),hex:"#"+(16777216|e|n<<8|i<<16).toString(16).slice(1)}}function r(e){var t,n=e.r,i=e.g,s=e.b;return(1<e.r||1<e.g||1<e.b)&&(n/=255,i/=255,s/=255),{h:n=(0==(t=(e=Math.max(n,i,s))-Math.min(n,i,s))?0:e==n?(i-s)/t+(i<s?6:0):e==i?(s-n)/t+2:(n-i)/t+4)%6*60,s:0==t?0:t/e,v:e}}function a(e,t,s){if(!(this instanceof a))return new a(e,t,s);this.h=0,this.v=this.s=1,s?(this.callback=s,this.pickerElement=t,this.slideElement=e):(e.innerHTML='<div class="picker-wrapper"><div class="picker"></div><div class="picker-indicator"></div></div><div class="slide-wrapper"><div class="slide"></div><div class="slide-indicator"></div></div>',this.slideElement=e.getElementsByClassName("slide")[0],this.pickerElement=e.getElementsByClassName("picker")[0],this.slideIndicator=e.getElementsByClassName("slide-indicator")[0],this.pickerIndicator=e.getElementsByClassName("picker-indicator")[0],a.positionIndicators(this.slideIndicator,this.pickerIndicator,{x:0,y:0},{x:0,y:0}),this.callback=function(e,n,i,s,o){a.positionIndicators(this.slideIndicator,this.pickerIndicator,o,s),t(e,n,i)}),this.slide_listener=function(e,t,s){return function(r){r=i(r,t),e.h=r.y/t.offsetHeight*360;var a=o({h:e.h,s:1,v:1}),l=o({h:e.h,s:e.s,v:e.v});s.style.backgroundColor=a.hex,e.callback&&e.callback(l.hex,{h:e.h,s:e.s,v:e.v},{r:l.r,g:l.g,b:l.b},n,r)}}(this,this.slideElement,this.pickerElement),this.picker_listener=function(e,t){return function(n){n=i(n,t);var s=t.offsetHeight;e.s=n.x/t.offsetWidth,e.v=(s-n.y)/s,s=o(e),e.callback&&e.callback(s.hex,{h:e.h,s:e.s,v:e.v},{r:s.r,g:s.g,b:s.b},n)}}(this,this.pickerElement),s||this.fixIndicators(this.slideIndicator,this.pickerIndicator),e=u.cloneNode(!0),s=c.cloneNode(!0);var r=e.getElementsByTagName("defs")[0].firstChild,d=e.getElementsByTagName("rect")[0];r.id="gradient-hsv-"+h,d.setAttribute("fill","url(#"+r.id+")"),r=[(r=s.getElementsByTagName("defs")[0]).firstChild,r.lastChild],d=s.getElementsByTagName("rect"),r[0].id="gradient-black-"+h,r[1].id="gradient-white-"+h,d[0].setAttribute("fill","url(#"+r[1].id+")"),d[1].setAttribute("fill","url(#"+r[0].id+")"),this.slideElement.appendChild(e),this.pickerElement.appendChild(s),h++,l(this.slideElement,this.slide_listener),l(this.pickerElement,this.picker_listener)}function l(e,n){function i(e){o&&n(e)}function s(e){i(e),o=!1,t.removeEventListener("mouseup",s,!1),t.removeEventListener("mousemove",i,!1)}var o=!1;e.addEventListener("mousedown",(function(e){o=!0,e.preventDefault(),t.addEventListener("mouseup",s,!0),t.addEventListener("mousemove",i,!1)}),!1)}function d(e,t,n,i){e.h=t.h%360,e.s=t.s,e.v=t.v,t=o(e);var s={y:e.h*e.slideElement.offsetHeight/360,x:0},r=e.pickerElement.offsetHeight;return r={x:e.s*e.pickerElement.offsetWidth,y:r-e.v*r},e.pickerElement.style.backgroundColor=o({h:e.h,s:1,v:1}).hex,e.callback&&e.callback(i||t.hex,{h:e.h,s:e.s,v:e.v},n||{r:t.r,g:t.g,b:t.b},r,s),e}var c,u,p={xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"100%",height:"100%"};u=s("svg",p,[s("defs",{},s("linearGradient",{id:"gradient-hsv",x1:"0%",y1:"100%",x2:"0%",y2:"0%"},[s("stop",{offset:"0%","stop-color":"#FF0000","stop-opacity":"1"}),s("stop",{offset:"13%","stop-color":"#FF00FF","stop-opacity":"1"}),s("stop",{offset:"25%","stop-color":"#8000FF","stop-opacity":"1"}),s("stop",{offset:"38%","stop-color":"#0040FF","stop-opacity":"1"}),s("stop",{offset:"50%","stop-color":"#00FFFF","stop-opacity":"1"}),s("stop",{offset:"63%","stop-color":"#00FF40","stop-opacity":"1"}),s("stop",{offset:"75%","stop-color":"#0BED00","stop-opacity":"1"}),s("stop",{offset:"88%","stop-color":"#FFFF00","stop-opacity":"1"}),s("stop",{offset:"100%","stop-color":"#FF0000","stop-opacity":"1"})])),s("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#gradient-hsv)"})]),c=s("svg",p,[s("defs",{},[s("linearGradient",{id:"gradient-black",x1:"0%",y1:"100%",x2:"0%",y2:"0%"},[s("stop",{offset:"0%","stop-color":"#000000","stop-opacity":"1"}),s("stop",{offset:"100%","stop-color":"#CC9A81","stop-opacity":"0"})]),s("linearGradient",{id:"gradient-white",x1:"0%",y1:"100%",x2:"100%",y2:"100%"},[s("stop",{offset:"0%","stop-color":"#FFFFFF","stop-opacity":"1"}),s("stop",{offset:"100%","stop-color":"#CC9A81","stop-opacity":"0"})])]),s("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#gradient-white)"}),s("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#gradient-black)"})]);var h=0;a.hsv2rgb=function(e){return delete(e=o(e)).hex,e},a.hsv2hex=function(e){return o(e).hex},a.rgb2hsv=r,a.rgb2hex=function(e){return o(r(e)).hex},a.hex2hsv=function(e){return r(a.hex2rgb(e))},a.hex2rgb=function(e){return{r:parseInt(e.substr(1,2),16),g:parseInt(e.substr(3,2),16),b:parseInt(e.substr(5,2),16)}},a.prototype.setHsv=function(e){return d(this,e)},a.prototype.setRgb=function(e){return d(this,r(e),e)},a.prototype.setHex=function(e){return d(this,a.hex2hsv(e),n,e)},a.positionIndicators=function(e,t,n,i){n&&(e.style.top=n.y-e.offsetHeight/2+"px"),i&&(t.style.top=i.y-t.offsetHeight/2+"px",t.style.left=i.x-t.offsetWidth/2+"px")},a.prototype.fixIndicators=function(e,t){l(e,this.slide_listener),l(t,this.picker_listener)},e.ColorPicker=a}(window,window.document)},6900:function(e,t,n){var i;!function(s){function o(e,t,n,i,s){this._listener=t,this._isOnce=n,this.context=i,this._signal=e,this._priority=s||0}function r(e,t){if("function"!=typeof e)throw Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",t))}function a(){this._bindings=[],this._prevParams=null;var e=this;this.dispatch=function(){a.prototype.dispatch.apply(e,arguments)}}o.prototype={active:!0,params:null,execute:function(e){var t;return this.active&&this._listener&&(e=this.params?this.params.concat(e):e,t=this._listener.apply(this.context,e),this._isOnce&&this.detach()),t},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},a.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(e,t,n,i){var s=this._indexOfListener(e,n);if(-1!==s){if((e=this._bindings[s]).isOnce()!==t)throw Error("You cannot add"+(t?"":"Once")+"() then add"+(t?"Once":"")+"() the same listener without removing the relationship first.")}else e=new o(this,e,t,n,i),this._addBinding(e);return this.memorize&&this._prevParams&&e.execute(this._prevParams),e},_addBinding:function(e){var t=this._bindings.length;do{--t}while(this._bindings[t]&&e._priority<=this._bindings[t]._priority);this._bindings.splice(t+1,0,e)},_indexOfListener:function(e,t){for(var n,i=this._bindings.length;i--;)if((n=this._bindings[i])._listener===e&&n.context===t)return i;return-1},has:function(e,t){return-1!==this._indexOfListener(e,t)},add:function(e,t,n){return r(e,"add"),this._registerListener(e,!1,t,n)},addOnce:function(e,t,n){return r(e,"addOnce"),this._registerListener(e,!0,t,n)},remove:function(e,t){r(e,"remove");var n=this._indexOfListener(e,t);return-1!==n&&(this._bindings[n]._destroy(),this._bindings.splice(n,1)),e},removeAll:function(){for(var e=this._bindings.length;e--;)this._bindings[e]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(e){if(this.active){var t,n=Array.prototype.slice.call(arguments),i=this._bindings.length;if(this.memorize&&(this._prevParams=n),i){t=this._bindings.slice(),this._shouldPropagate=!0;do{i--}while(t[i]&&this._shouldPropagate&&!1!==t[i].execute(n))}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var l=a;l.Signal=a,void 0===(i=function(){return l}.call(t,n,t,e))||(e.exports=i)}()},5395:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeManagerView=t.ThemeManagerModel=void 0;const i=n(8731),s=n(7410),o=n(7708);class r extends o.DOMWidgetModel{defaults(){return i.extend(o.DOMWidgetModel.prototype.defaults(),{_model_name:"ThemeManagerModel",_model_module:"nglview-js-widgets",_model_module_version:n(306).version,_view_name:"ThemeManagerView",_view_module:"nglview-js-widgets",_view_module_version:n(306).version})}}t.ThemeManagerModel=r;class a extends s.BaseView{render(){super.render(),this.displayed.then((()=>this.handleThemeChanged()))}handleThemeChanged(){console.log("ThemeManagerView: handleThemeChanged"),this.setTheme(this.model.get("_theme_css"))}handleEmbed(){this.handleThemeChanged()}setTheme(e){if(null!=e){var t=document.getElementById("nglview_style");t&&document.head.removeChild(t),(t=document.createElement("style")).id="nglview_style",t.appendChild(document.createTextNode(e)),document.head.appendChild(t),this.send({type:"call_method",data:"handle_resize"})}}}t.ThemeManagerView=a},8490:(e,t,n)=>{var i=n(7579).UI;i.Html=function(e){i.Element.call(this);var t=document.createElement("span");return t.className="Html",t.style.cursor="default",t.style.display="inline-block",t.style.verticalAlign="middle",this.dom=t,this.setValue(e),this},i.Html.prototype=Object.create(i.Element.prototype),i.Html.prototype.setValue=function(e){return void 0!==e&&(this.dom.innerHTML=e),this},i.Form=function(){i.Panel.call(this);var e=document.createElement("form");return e.className="Form",e.method="post",e.action="",e.target="_blank",e.enctype="multipart/form-data",this.dom=e,this},i.Form.prototype=Object.create(i.Panel.prototype),i.Form.prototype.setMethod=function(e){return this.dom.method=e,this},i.Form.prototype.setAction=function(e){return this.dom.action=e,this},i.Form.prototype.setTarget=function(e){return this.dom.target=e,this},i.Form.prototype.setEnctype=function(e){return this.dom.enctype=e,this},i.File=function(){return i.Input.call(this),this.dom.className="File",this.dom.type="file",this.dom.multiple=!1,this},i.File.prototype=Object.create(i.Input.prototype),i.File.prototype.setMultiple=function(e){return this.dom.multiple=e,this},i.File.prototype.getFiles=function(e){return this.dom.files},i.Hidden=function(){return i.Input.call(this),this.dom.type="hidden",this},i.Hidden.prototype=Object.create(i.Input.prototype),i.ToggleButton=function(e,t,n,s){i.Button.call(this,t);var o=!0;return this.onClick(function(){o?(o=!1,this.setLabel(e),s()):(o=!0,this.setLabel(t),n())}.bind(this)),this},i.ToggleButton.prototype=Object.create(i.Button.prototype),i.EllipsisText=function(e){return i.Text.call(this,e),this.setWhiteSpace("nowrap"),this.setOverflow("hidden"),this.setTextOverflow("ellipsis"),this},i.EllipsisText.prototype=Object.create(i.Text.prototype),i.EllipsisText.prototype.setValue=function(e){return void 0!==e&&(this.dom.textContent=e,this.setTitle(e)),this},i.EllipsisMultilineText=function(e){i.Element.call(this);var t=document.createElement("span");t.className="EllipsisMultilineText",t.style.cursor="default",t.style.display="inline-block",t.style.verticalAlign="middle";var n=document.createElement("p");return t.appendChild(n),this.dom=t,this.content=n,this.setValue(e),this},i.EllipsisMultilineText.prototype=Object.create(i.Element.prototype),i.EllipsisMultilineText.prototype.setValue=function(e){return void 0!==e&&(this.content.textContent=e,this.setTitle(e)),this},i.OverlayPanel=function(){return i.Panel.call(this),this.dom.className="Panel OverlayPanel",this.dom.tabIndex="-1",this.dom.style.outline="none",this},i.OverlayPanel.prototype=Object.create(i.Panel.prototype),i.OverlayPanel.prototype.attach=function(e){return(e=e||document.body).appendChild(this.dom),this},i.Icon=function(e){i.Panel.call(this);var t=document.createElement("span");return t.className="Icon fa",this.dom=t,e&&this.addClass.apply(this,arguments),this},i.Icon.prototype=Object.create(i.Panel.prototype),i.Icon.prototype.hasClass=function(e){return this.dom.classList.contains("fa-"+e)},i.Icon.prototype.addClass=function(e){for(var t=0;t<arguments.length;t++)this.dom.classList.add("fa-"+arguments[t]);return this},i.Icon.prototype.setClass=function(e){this.dom.className="Icon fa";for(var t=0;t<arguments.length;t++)this.dom.classList.add("fa-"+arguments[t]);return this},i.Icon.prototype.removeClass=function(e){for(var t=0;t<arguments.length;t++)this.dom.classList.remove("fa-"+arguments[t]);return this},i.Icon.prototype.switchClass=function(e,t){return this.removeClass(t,e),this.addClass(e),this},i.ToggleIcon=function(e,t,n){return i.Icon.call(this,e?t:n),this.value=e,this.classTrue=t,this.classFalse=n,this},i.ToggleIcon.prototype=Object.create(i.Icon.prototype),i.ToggleIcon.prototype.setValue=function(e){return this.value=e,e?this.switchClass(this.classTrue,this.classFalse):this.switchClass(this.classFalse,this.classTrue),this},i.ToggleIcon.prototype.getValue=function(){return this.value},i.DisposeIcon=function(){i.Icon.call(this,"trash-o");var e=!1,t=this;return this.setTitle("delete"),this.setCursor("pointer"),this.onClick((function(){!0===e?"function"==typeof t.disposeFunction&&t.disposeFunction():(t.setColor("rgb(178, 34, 34)"),t.dom.classList.add("deleteInfo"),e=!0,setTimeout((function(){t.setColor("#888"),t.dom.classList.remove("deleteInfo"),e=!1}),1500))})),this},i.DisposeIcon.prototype=Object.create(i.Icon.prototype),i.DisposeIcon.prototype.setDisposeFunction=function(e){return this.disposeFunction=e,this},i.Progress=function(e,t){i.Element.call(this);var n=document.createElement("progress");return n.className="Progress",n.max=e||1,void 0!==t&&(n.value=t),this.dom=n,this},i.Progress.prototype=Object.create(i.Element.prototype),i.Progress.prototype.getValue=function(){return this.dom.value},i.Progress.prototype.setValue=function(e){return this.dom.value=e,this},i.Progress.prototype.setMax=function(e){return this.dom.max=e,this},i.Progress.prototype.setIndeterminate=function(){return this.dom.removeAttribute("value"),this},i.Range=function(e,t,n,s){i.Element.call(this);var o=document.createElement("input");return o.className="Range",o.type="range",o.min=e.toPrecision(3),o.max=t.toPrecision(3),o.value=n.toPrecision(3),o.step=s.toPrecision(3),this.dom=o,this},i.Range.prototype=Object.create(i.Element.prototype),i.Range.prototype.getValue=function(){return parseFloat(this.dom.value)},i.Range.prototype.setRange=function(e,t){return this.dom.min=e,this.dom.max=t,this},i.Range.prototype.setValue=function(e){return this.dom.value=e,this},i.Range.prototype.setStep=function(e){return this.dom.step=e,this},i.AdaptiveTextArea=function(){i.Element.call(this);var e=document.createElement("div");e.className="AdaptiveTextAreaContainer";var t=document.createElement("textarea");t.className="AdaptiveTextArea";var n=document.createElement("div");return n.className="AdaptiveTextAreaSize",e.appendChild(t),e.appendChild(n),t.addEventListener("input",(function(e){n.innerHTML=t.value+"\n"}),!1),this.textarea=t,this.size=n,this.dom=e,this},i.AdaptiveTextArea.prototype=Object.create(i.Element.prototype),i.AdaptiveTextArea.prototype.getValue=function(){return this.textarea.value},i.AdaptiveTextArea.prototype.setValue=function(e){return this.textarea.value=e,this.size.innerHTML=e+"\n",this},i.AdaptiveTextArea.prototype.setSpellcheck=function(e){return this.textarea.spellcheck=e,this},i.AdaptiveTextArea.prototype.setBackgroundColor=function(e){return this.textarea.style.backgroundColor=e,this},i.VirtualList=function(e,t,n,s){i.Element.call(this),e=e||[],t=t||20,n=n||300,s=s||function(){};var o=document.createElement("div");o.className="VirtualList",o.style.height=n+"px";var r,a=e.length,l=Math.ceil(n/t),d=3*l,c=l*t,u=0,p=function(){},h=document.createElement("div");h.style.width="100%",h.style.height=n+"px",h.style["overflow-y"]="auto",h.style.position="relative",h.style.padding=0;var m=document.createElement("div");function g(e){var n=s(e);return n.classList.add("VirtualListRow"),n.style.height=t+"px",n.style.top=e*t+"px",n}function f(e){var t=Math.min(a,e+d);p(e,t);for(var n=document.createDocumentFragment(),i=e;i<t;i++)n.appendChild(g(i));for(var s=1,o=h.childNodes.length;s<o;s++)h.childNodes[s].style.display="none",h.childNodes[s].setAttribute("data-rm","1");h.appendChild(n)}m.style.opacity=0,m.style.position="absolute",m.style.top=0,m.style.left=0,m.style.width="1px",m.style.height=t*a+"px";var v=setInterval((function(){for(var e=o;e!==document&&e.parentNode;)e=e.parentNode;if(e!==document&&clearInterval(v),Date.now()-u>100)for(var t=h.querySelectorAll('[data-rm="1"]'),n=0,i=t.length;n<i;n++)h.removeChild(t[n])}),500);return this.setItems=function(n){return a=(e=n).length,m.style.height=t*a+"px",f(0),this},this.setItemHeight=function(e){return t=e,l=Math.ceil(n/t),d=3*l,c=l*t,m.style.height=t*a+"px",f(0),this},this.setHeight=function(e){return i.Element.prototype.setHeight.call(this,e+"px"),n=e,l=Math.ceil(n/t),d=3*l,c=l*t,h.style.height=n+"px",m.style.height=n+"px",f(0),this},this.setGeneratorFn=function(e){return s=e,f(0),this},this.setRenderChunkCallback=function(e){p=e},this.redraw=function(){var e=Math.floor(h.scrollTop/t);return f(Math.max(0,e-l)),r=h.scrollTop,this},h.appendChild(m),o.appendChild(h),h.addEventListener("scroll",(function(e){var n=e.target.scrollTop;if(!r||Math.abs(n-r)>c){var i=Math.floor(n/t);f(Math.max(0,i-l)),r=n}u=Date.now(),e.preventDefault&&e.preventDefault()})),f(0),this.dom=o,this},i.VirtualList.prototype=Object.create(i.Element.prototype),i.VirtualTable=function(e,t,n,s,o){var r=o||{};i.Panel.call(this);var a=void 0!==r.defaultWidth?r.defaultWidth:30,l=void 0!==r.defaultMargin?r.defaultMargin:5,d=void 0!==r.defaultAlign?r.defaultAlign:"left",c=r.onRowSelect,u=(new i.Panel).setWhiteSpace("nowrap").setDisplay("inline-block").setOverflow("").setWidth("100%"),p=0,h=[],m=function(e,t){return e-t},g=function(e,t){return e.localeCompare(t)},f=function(t,n){var i;return i="string"==typeof e[0][t]?g:m,e.sort((function(e,s){return n?i(s[t],e[t]):i(e[t],s[t])})),y.redraw(),this},v=function(t,n){return h.length=0,c&&c(t,n),void 0!==n&&h.push(e[n][0]),y.redraw(),this};s.forEach((function(e){var t=e.width||a,n=e.margin||l,s=(new i.EllipsisText).setValue(e.name).setWidth(t+"px").setTextAlign(e.align||d).setMarginLeft(n+"px").setMarginRight(n+"px").setCursor("pointer").onClick((function(t){var n="ASC"===e.__sortFlag;f(e.index,n),e.__sortFlag=n?"DESC":"ASC"}));u.add(s),p+=t+2*n}));var y=new i.VirtualList(e,t,n,(function(t){var n=new i.Panel;return s.forEach((function(s){var o=e[t][s.index];s.format&&(o=s.format(o));var r,c=s.width||a,u=s.margin||l;(r="object"==typeof o?o:(new i.Text).setValue(o)).setWidth(c+"px").setTextAlign(s.align||d).setMarginLeft(u+"px").setMarginRight(u+"px").onClick((function(e){"function"==typeof s.onClick&&s.onClick(e,t,o)})).onMouseOver((function(e){"function"==typeof s.onMouseOver&&s.onMouseOver(e,t,o)})).onMouseOut((function(e){"function"==typeof s.onMouseOut&&s.onMouseOut(e,t,o)})),n.add(r)})),n.setCursor("pointer").onClick((function(e){v(e,t)})),-1!==h.indexOf(e[t][0])&&n.dom.classList.add("highlight"),n.dom})).setWidth(p+20+"px");return this.add(u,y),this.header=u,this.list=y,this.sortColumn=f,this.selectRow=function(e){v(void 0,e)},this},i.VirtualTable.prototype=Object.create(i.Panel.prototype),i.PopupMenu=function(e,t,n){n=n||"scrollParent",i.Panel.call(this);var s=new i.Icon(e||"bars"),o=(new i.OverlayPanel).setDisplay("none").attach(this.dom),r=0;function a(e){0===r&&(r=e.clientX,e.clientY),e.clientX,e.clientY,r=e.clientX,e.clientY}var l=(new i.Panel).setBorderBottom("1px solid #555").setMarginBottom("10px").setHeight("25px").setCursor("move").onMouseDown((function(e){1===e.which&&document.addEventListener("mousemove",a),document.addEventListener("mouseup",(function(e){document.removeEventListener("mousemove",a)}))}));return l.add(new i.Icon("times").setFloat("right").setCursor("pointer").onClick(function(){this.setMenuDisplay("none")}.bind(this))).add(new i.Text(t)),o.add(l),s.setTitle("menu"),s.setCursor("pointer"),s.onClick(function(e){"block"!==o.getDisplay()?(o.setMaxHeight(window.innerHeight/1.2+"px"),this.setMenuDisplay("block")):this.setMenuDisplay("none")}.bind(this)),this.add(s),this.setClass("").setDisplay("inline"),this.icon=s,this.panel=o,this.entryLabelWidth="100px",this},i.PopupMenu.prototype=Object.create(i.Panel.prototype),i.PopupMenu.prototype.addEntry=function(e,t){return this.panel.add(new i.Text(e).setWidth(this.entryLabelWidth)).add(t||new i.Panel).add(new i.Break),this},i.PopupMenu.prototype.setEntryLabelWidth=function(e){return this.entryLabelWidth=e,this},i.PopupMenu.prototype.setMenuDisplay=function(e){return this.panel.setDisplay(e),"none"!==e&&this.panel.dom.focus(),this},i.PopupMenu.prototype.setIconTitle=function(e){return this.icon.setTitle(e),this},i.PopupMenu.prototype.dispose=function(){this.panel.dispose(),i.Element.prototype.dispose.call(this)},i.CollapsibleIconPanel=function(e,t){i.Panel.call(this),this.dom.className="Panel CollapsiblePanel",void 0===e&&(e=e||"chevron-down",t=t||"chevron-right"),this.button=new i.Icon(e).setTitle("expand/collapse").setCursor("pointer").setWidth("12px").setMarginRight("6px"),this.addStatic(this.button);var n=this;return this.button.dom.addEventListener("click",(function(e){n.toggle()}),!1),this.content=document.createElement("div"),this.content.className="CollapsibleContent",this.dom.appendChild(this.content),this.isCollapsed=!1,this.iconClass1=e,this.iconClass2=t,this},i.CollapsibleIconPanel.prototype=Object.create(i.CollapsiblePanel.prototype),i.CollapsibleIconPanel.prototype.setCollapsed=function(e){e?(this.dom.classList.add("collapsed"),this.iconClass2?this.button.switchClass(this.iconClass2,this.iconClass1):this.button.addClass("rotate-90")):(this.dom.classList.remove("collapsed"),this.iconClass2?this.button.switchClass(this.iconClass1,this.iconClass2):this.button.removeClass("rotate-90")),this.isCollapsed=e},i.ColorPicker=function(){var e=this;i.Panel.call(this),this.slideWrapper=(new i.Panel).setClass("slide-wrapper"),this.sliderIndicator=(new i.Panel).setClass("slide-indicator"),this.slider=(new i.Panel).setClass("slide").setWidth("25px").setHeight("80px"),this.slideWrapper.add(this.slider,this.sliderIndicator),this.pickerWrapper=(new i.Panel).setClass("picker-wrapper"),this.pickerIndicator=(new i.Panel).setClass("picker-indicator"),this.picker=(new i.Panel).setClass("picker").setWidth("130px").setHeight("80px"),this.pickerWrapper.add(this.picker,this.pickerIndicator);var t=document.createEvent("Event");return t.initEvent("change",!0,!0),this.add(this.pickerWrapper,this.slideWrapper),this.colorPicker=ColorPicker(this.slider.dom,this.picker.dom,(function(n,i,s,o,r){if(!o&&r&&i.s<.05)return i.s=.5,i.v=.7,void e.colorPicker.setHsv(i);ColorPicker.positionIndicators(e.sliderIndicator.dom,e.pickerIndicator.dom,r,o),e.hex=n,e.hsv=i,e.rgb=s,e._settingValue||e.dom.dispatchEvent(t)})),this.colorPicker.fixIndicators(this.sliderIndicator.dom,this.pickerIndicator.dom),this},i.ColorPicker.prototype=Object.create(i.Panel.prototype),i.ColorPicker.prototype.setValue=function(e){return e!==this.hex&&(this._settingValue=!0,this.colorPicker.setHex(e),this._settingValue=!1),this},i.ColorPicker.prototype.getValue=function(){return this.hex},e.exports={UI:i}},7579:e=>{var t={Element:function(){}};t.Element.prototype={setId:function(e){return this.dom.id=e,this},setTitle:function(e){return this.dom.title=e,this},setClass:function(e){return this.dom.className=e,this},setStyle:function(e,t){for(var n=0;n<t.length;n++)this.dom.style[e]=t[n]},getStyle:function(e){return this.dom.style[e]},getBox:function(){return this.dom.getBoundingClientRect()},setDisabled:function(e){return this.dom.disabled=e,this},setTextContent:function(e){return this.dom.textContent=e,this},dispose:function(){this.dom.parentNode.removeChild(this.dom)}},["position","left","top","right","bottom","width","height","border","borderLeft","borderTop","borderRight","borderBottom","borderColor","display","overflow","overflowX","overflowY","margin","marginLeft","marginTop","marginRight","marginBottom","padding","paddingLeft","paddingTop","paddingRight","paddingBottom","color","backgroundColor","opacity","fontSize","fontWeight","fontStyle","fontFamily","textTransform","cursor","verticalAlign","clear","float","zIndex","minHeight","maxHeight","minWidth","maxWidth","wordBreak","wordWrap","spellcheck","lineHeight","whiteSpace","textOverflow","textAlign","pointerEvents"].forEach((function(e){var n=e.substr(0,1).toUpperCase()+e.substr(1,e.length);t.Element.prototype["set"+n]=function(){return this.setStyle(e,arguments),this},t.Element.prototype["get"+n]=function(){return this.getStyle(e)}})),["KeyUp","KeyDown","KeyPress","MouseOver","MouseOut","MouseDown","MouseUp","MouseMove","Click","Change","Input","Scroll"].forEach((function(e){var n="on"+e;t.Element.prototype[n]=function(t){return this.dom.addEventListener(e.toLowerCase(),t.bind(this),!1),this}})),t.Panel=function(){t.Element.call(this);var e=document.createElement("div");return e.className="Panel",this.dom=e,this.children=[],this},t.Panel.prototype=Object.create(t.Element.prototype),t.Panel.prototype.add=function(){for(var e=0;e<arguments.length;e++)this.dom.appendChild(arguments[e].dom),this.children.push(arguments[e]);return this},t.Panel.prototype.remove=function(){for(var e=0;e<arguments.length;e++){this.dom.removeChild(arguments[e].dom);var t=this.children.indexOf(arguments[e]);-1!==t&&this.children.splice(t,1)}return this},t.Panel.prototype.clear=function(){for(;this.dom.children.length;)this.dom.removeChild(this.dom.lastChild);return this.children.length=0,this},t.CollapsiblePanel=function(){t.Panel.call(this),this.dom.className="Panel CollapsiblePanel",this.button=document.createElement("div"),this.button.className="CollapsiblePanelButton",this.dom.appendChild(this.button);var e=this;return this.button.addEventListener("click",(function(t){e.toggle()}),!1),this.content=document.createElement("div"),this.content.className="CollapsibleContent",this.dom.appendChild(this.content),this.isCollapsed=!1,this},t.CollapsiblePanel.prototype=Object.create(t.Panel.prototype),t.CollapsiblePanel.prototype.addStatic=function(){for(var e=0;e<arguments.length;e++)this.dom.insertBefore(arguments[e].dom,this.content);return this},t.CollapsiblePanel.prototype.removeStatic=t.Panel.prototype.remove,t.CollapsiblePanel.prototype.clearStatic=function(){this.dom.childNodes.forEach((function(e){e!==this.content&&this.dom.removeChild(e)}))},t.CollapsiblePanel.prototype.add=function(){for(var e=0;e<arguments.length;e++)this.content.appendChild(arguments[e].dom);return this},t.CollapsiblePanel.prototype.remove=function(){for(var e=0;e<arguments.length;e++)this.content.removeChild(arguments[e].dom);return this},t.CollapsiblePanel.prototype.clear=function(){for(;this.content.children.length;)this.content.removeChild(this.content.lastChild)},t.CollapsiblePanel.prototype.toggle=function(){this.setCollapsed(!this.isCollapsed)},t.CollapsiblePanel.prototype.collapse=function(){this.setCollapsed(!0)},t.CollapsiblePanel.prototype.expand=function(){this.setCollapsed(!1)},t.CollapsiblePanel.prototype.setCollapsed=function(e){e?this.dom.classList.add("collapsed"):this.dom.classList.remove("collapsed"),this.isCollapsed=e},t.Text=function(e){t.Element.call(this);var n=document.createElement("span");return n.className="Text",n.style.display="inline-block",n.style.verticalAlign="middle",this.dom=n,this.setValue(e),this},t.Text.prototype=Object.create(t.Element.prototype),t.Text.prototype.setValue=function(e){return void 0!==e&&(this.dom.textContent=e),this},t.Text.prototype.setName=function(e){return this.dom.name=e,this},t.Input=function(e){t.Element.call(this);var n=document.createElement("input");return n.className="Input",n.style.padding="2px",n.style.border="1px solid #ccc",n.addEventListener("keydown",(function(e){e.stopPropagation()}),!1),this.dom=n,this.setValue(e||""),this},t.Input.prototype=Object.create(t.Element.prototype),t.Input.prototype.getValue=function(){return this.dom.value},t.Input.prototype.setValue=function(e){return this.dom.value=e,this},t.Input.prototype.setName=function(e){return this.dom.name=e,this},t.TextArea=function(){t.Element.call(this);var e=document.createElement("textarea");return e.className="TextArea",e.style.padding="2px",e.style.border="1px solid #ccc",e.addEventListener("keydown",(function(e){e.stopPropagation()}),!1),this.dom=e,this},t.TextArea.prototype=Object.create(t.Element.prototype),t.TextArea.prototype.getValue=function(){return this.dom.value},t.TextArea.prototype.setValue=function(e){return this.dom.value=e,this},t.Select=function(){t.Element.call(this);var e=document.createElement("select");return e.className="Select",e.style.width="64px",e.style.height="16px",e.style.border="0px",e.style.padding="0px",this.dom=e,this},t.Select.prototype=Object.create(t.Element.prototype),t.Select.prototype.setMultiple=function(e){return this.dom.multiple=e,this},t.Select.prototype.setOptions=function(e){for(var t=this.dom.value;this.dom.children.length>0;)this.dom.removeChild(this.dom.firstChild);for(var n in e){var i=document.createElement("option");i.value=n,i.innerHTML=e[n],this.dom.appendChild(i)}return this.dom.value=t,this},t.Select.prototype.getValue=function(){return this.dom.value},t.Select.prototype.setValue=function(e){return this.dom.value=e,this},t.Select.prototype.setName=function(e){return this.dom.name=e,this},t.FancySelect=function(){t.Element.call(this);var e=this,n=document.createElement("div");n.className="FancySelect",n.tabIndex=0;var i=document.createEvent("HTMLEvents");return i.initEvent("change",!0,!0),n.addEventListener("keydown",(function(e){switch(e.keyCode){case 38:case 40:e.preventDefault(),e.stopPropagation()}}),!1),n.addEventListener("keyup",(function(t){switch(t.keyCode){case 38:case 40:e.selectedIndex+=38==t.keyCode?-1:1,e.selectedIndex>=0&&e.selectedIndex<e.options.length&&(e.setValue(e.options[e.selectedIndex].value),e.dom.dispatchEvent(i))}}),!1),this.dom=n,this.options=[],this.selectedIndex=-1,this.selectedValue=null,this},t.FancySelect.prototype=Object.create(t.Element.prototype),t.FancySelect.prototype.setOptions=function(e){var t=this,n=document.createEvent("HTMLEvents");for(n.initEvent("change",!0,!0);t.dom.children.length>0;)t.dom.removeChild(t.dom.firstChild);t.options=[];for(var i=0;i<e.length;i++){var s=e[i],o=document.createElement("div");o.className="option",o.innerHTML=s.html,o.value=s.value,t.dom.appendChild(o),t.options.push(o),o.addEventListener("click",(function(e){t.setValue(this.value),t.dom.dispatchEvent(n)}),!1)}return t},t.FancySelect.prototype.getValue=function(){return this.selectedValue},t.FancySelect.prototype.setValue=function(e){for(var t=0;t<this.options.length;t++){var n=this.options[t];if(n.value===e){n.classList.add("active");var i=n.offsetTop-this.dom.offsetTop,s=i+n.offsetHeight-this.dom.offsetHeight;this.dom.scrollTop>i?this.dom.scrollTop=i:this.dom.scrollTop<s&&(this.dom.scrollTop=s),this.selectedIndex=t}else n.classList.remove("active")}return this.selectedValue=e,this},t.Checkbox=function(e){t.Element.call(this);var n=document.createElement("input");return n.className="Checkbox",n.type="checkbox",this.dom=n,this.setValue(e),this},t.Checkbox.prototype=Object.create(t.Element.prototype),t.Checkbox.prototype.getValue=function(){return this.dom.checked},t.Checkbox.prototype.setValue=function(e){return void 0!==e&&(this.dom.checked=e),this},t.Checkbox.prototype.setName=function(e){return this.dom.name=e,this},t.Color=function(){t.Element.call(this);var e=document.createElement("input");e.className="Color",e.style.width="64px",e.style.height="16px",e.style.border="0px",e.style.padding="0px",e.style.backgroundColor="transparent";try{e.type="color",e.value="#ffffff"}catch(e){}return this.dom=e,this},t.Color.prototype=Object.create(t.Element.prototype),t.Color.prototype.getValue=function(){return this.dom.value},t.Color.prototype.getHexValue=function(){return parseInt(this.dom.value.substr(1),16)},t.Color.prototype.setValue=function(e){return this.dom.value=e,this},t.Color.prototype.setHexValue=function(e){return this.dom.value="#"+("000000"+e.toString(16)).slice(-6),this},t.Number=function(e){t.Element.call(this);var n=this,i=document.createElement("input");i.className="Number",i.value="0.00",i.addEventListener("keydown",(function(e){e.stopPropagation(),13===e.keyCode&&i.blur()}),!1),this.min=-1/0,this.max=1/0,this.precision=2,this.step=1,this.dom=i,this.setValue(e);var s=document.createEvent("HTMLEvents");s.initEvent("change",!0,!0);var o=0,r=0,a=[0,0],l=[0,0],d=function(e){var t=i.value;a=[e.clientX,e.clientY],o+=a[0]-l[0]-(a[1]-l[1]);var d=50;e.shiftKey&&(d=5),e.ctrlKey&&(d=500);var c=r+o/d*n.step;i.value=Math.min(n.max,Math.max(n.min,c)).toFixed(n.precision),t!==i.value&&i.dispatchEvent(s),l=[e.clientX,e.clientY]},c=function(e){document.removeEventListener("mousemove",d,!1),document.removeEventListener("mouseup",c,!1),Math.abs(o)<2&&(i.focus(),i.select())};return i.addEventListener("mousedown",(function(e){e.preventDefault(),o=0,r=parseFloat(i.value),l=[e.clientX,e.clientY],document.addEventListener("mousemove",d,!1),document.addEventListener("mouseup",c,!1)}),!1),i.addEventListener("change",(function(e){var t=parseFloat(i.value);i.value=!1===isNaN(t)?t:0}),!1),i.addEventListener("focus",(function(e){i.style.backgroundColor="",i.style.borderColor="#ccc",i.style.cursor=""}),!1),i.addEventListener("blur",(function(e){i.style.backgroundColor="transparent",i.style.borderColor="transparent",i.style.cursor="col-resize"}),!1),this},t.Number.prototype=Object.create(t.Element.prototype),t.Number.prototype.getValue=function(){return parseFloat(this.dom.value)},t.Number.prototype.setValue=function(e){return isNaN(e)?this.dom.value=NaN:void 0!==e&&(this.dom.value=e.toFixed(this.precision)),this},t.Number.prototype.setRange=function(e,t){return this.min=e,this.max=t,this},t.Number.prototype.setPrecision=function(e){return this.precision=e,this.setValue(parseFloat(this.dom.value)),this},t.Number.prototype.setName=function(e){return this.dom.name=e,this},t.Integer=function(e){t.Element.call(this);var n=this,i=document.createElement("input");i.className="Number",i.value="0.00",i.addEventListener("keydown",(function(e){e.stopPropagation()}),!1),this.min=-1/0,this.max=1/0,this.step=1,this.dom=i,this.setValue(e);var s=document.createEvent("HTMLEvents");s.initEvent("change",!0,!0);var o=0,r=0,a=[0,0],l=[0,0],d=function(e){var t=i.value;a=[e.clientX,e.clientY],o+=a[0]-l[0]-(a[1]-l[1]);var d=50;e.shiftKey&&(d=5),e.ctrlKey&&(d=500);var c=r+o/d*n.step;i.value=0|Math.min(n.max,Math.max(n.min,c)),t!==i.value&&i.dispatchEvent(s),l=[e.clientX,e.clientY]},c=function(e){document.removeEventListener("mousemove",d,!1),document.removeEventListener("mouseup",c,!1),Math.abs(o)<2&&(i.focus(),i.select())};return i.addEventListener("mousedown",(function(e){e.preventDefault(),o=0,r=parseFloat(i.value),l=[e.clientX,e.clientY],document.addEventListener("mousemove",d,!1),document.addEventListener("mouseup",c,!1)}),!1),i.addEventListener("change",(function(e){var t=parseInt(i.value);!1===isNaN(t)&&(i.value=t)}),!1),i.addEventListener("focus",(function(e){i.style.backgroundColor="",i.style.borderColor="#ccc",i.style.cursor=""}),!1),i.addEventListener("blur",(function(e){i.style.backgroundColor="transparent",i.style.borderColor="transparent",i.style.cursor="col-resize"}),!1),this},t.Integer.prototype=Object.create(t.Element.prototype),t.Integer.prototype.getValue=function(){return parseInt(this.dom.value)},t.Integer.prototype.setValue=function(e){return void 0!==e&&(this.dom.value=0|e),this},t.Integer.prototype.setRange=function(e,t){return this.min=e,this.max=t,this},t.Integer.prototype.setName=function(e){return this.dom.name=e,this},t.Integer.prototype.setStep=function(e){return this.step=e,this},t.Break=function(){t.Element.call(this);var e=document.createElement("br");return e.className="Break",this.dom=e,this},t.Break.prototype=Object.create(t.Element.prototype),t.HorizontalRule=function(){t.Element.call(this);var e=document.createElement("hr");return e.className="HorizontalRule",this.dom=e,this},t.HorizontalRule.prototype=Object.create(t.Element.prototype),t.Button=function(e){t.Element.call(this);var n=document.createElement("button");return n.className="Button",this.dom=n,this.dom.textContent=e,this},t.Button.prototype=Object.create(t.Element.prototype),t.Button.prototype.setLabel=function(e){return this.dom.textContent=e,this},t.MenubarHelper={createMenuContainer:function(e,n){var i=new t.Panel,s=new t.Panel;return s.setClass("title"),s.setTextContent(e),s.setMargin("0px"),s.setPadding("8px"),i.setClass("menu"),i.add(s),i.add(n),i},createOption:function(e,n,i){var s=new t.Panel;return s.setClass("option"),i?(s.add(new t.Icon(i).setWidth("20px")),s.add(new t.Text(e))):s.setTextContent(e),s.onClick(n),s},createOptionsPanel:function(e){var n=new t.Panel;return n.setClass("options"),e.forEach((function(e){n.add(e)})),n},createInput:function(e,n){var i=(new t.Panel).setClass("option"),s=(new t.Text).setWidth("70px").setValue(e),o=(new t.Input).setWidth("40px").onKeyDown(n);return i.add(s),i.add(o),i},createCheckbox:function(e,n,i){var s=(new t.Panel).setClass("option"),o=(new t.Text).setWidth("70px").setValue(e),r=(new t.Checkbox).setValue(n).onClick(i);return s.add(r),s.add(o),s},createDivider:function(){return new t.HorizontalRule}},e.exports={UI:t}},5379:(e,t,n)=>{var i,s=n(2280),o=n(8490).UI;o.ColorPopupMenu=function(){var e=this;o.Panel.call(this),this.iconText=new o.Text("").setCursor("pointer").setClass("fa-stack-1x").setFontFamily("Arial, sans-serif").setColor("#111"),this.iconSquare=new o.Icon("square","stack-1x"),this.menu=new o.PopupMenu("stack","Color"),this.menu.icon.setTitle("color").setWidth("1em").setHeight("1em").setLineHeight("1em").add(this.iconSquare).add(this.iconText);var t=document.createEvent("Event");return t.initEvent("change",!0,!0),this.colorInput=(new o.Input).onChange((function(){e.setColor(e.colorInput.getValue()),e.dom.dispatchEvent(t)})),this.colorPicker=(new o.ColorPicker).setDisplay("inline-block").onChange((function(n){e.setColor(e.colorPicker.getValue()),e.dom.dispatchEvent(t)})),this.menu.addEntry("Input",this.colorInput).addEntry("Picker",this.colorPicker),this.add(this.menu),this.setClass("").setDisplay("inline"),this},o.ColorPopupMenu.prototype=Object.create(o.Panel.prototype),o.ColorPopupMenu.prototype.setColor=(i=new s.Color,function(e){return i.set(e),e="#"+i.getHexString(),this.colorInput.setBackgroundColor(e).setValue(e),this.colorPicker.setValue(e),this.iconSquare.setColor(e),Math.sqrt(255*i.r*i.r*255*.241+255*i.g*i.g*255*.691+255*i.b*i.b*255*.068)>130?(this.iconText.setColor("#000000"),this.colorInput.setColor("#000000")):(this.iconText.setColor("#FFFFFF"),this.colorInput.setColor("#FFFFFF")),this}),o.ColorPopupMenu.prototype.getColor=function(){return this.colorInput.getValue()},o.ColorPopupMenu.prototype.getValue=function(){return this.getColor()},o.ColorPopupMenu.prototype.setValue=function(e){return this.setColor(e),this},o.ColorPopupMenu.prototype.dispose=function(){this.menu.dispose(),o.Panel.prototype.dispose.call(this)},o.Vector3=function(e){o.Panel.call(this).setDisplay("inline-block"),this.xNumber=new o.Number(0).setWidth("40px"),this.yNumber=new o.Number(0).setWidth("40px"),this.zNumber=new o.Number(0).setWidth("40px"),this.add(this.xNumber,this.yNumber,this.zNumber),this.setValue(e);var t=document.createEvent("Event");return t.initEvent("change",!0,!0),this.xNumber.onChange(function(){this.dom.dispatchEvent(t)}.bind(this)),this.yNumber.onChange(function(){this.dom.dispatchEvent(t)}.bind(this)),this.zNumber.onChange(function(){this.dom.dispatchEvent(t)}.bind(this)),this},o.Vector3.prototype=Object.create(o.Panel.prototype),o.Vector3.prototype.getValue=function(){return{x:this.xNumber.getValue(),y:this.yNumber.getValue(),z:this.zNumber.getValue()}},o.Vector3.prototype.setValue=function(e){return e&&(this.xNumber.setValue(e.x),this.yNumber.setValue(e.y),this.zNumber.setValue(e.z)),this},o.Vector3.prototype.setPrecision=function(e){return this.xNumber.setPrecision(e),this.yNumber.setPrecision(e),this.zNumber.setPrecision(e),this},o.Vector3.prototype.setRange=function(e,t){return this.xNumber.setRange(e,t),this.yNumber.setRange(e,t),this.zNumber.setRange(e,t),this},o.SelectionInput=function(e){if(o.AdaptiveTextArea.call(this),this.setSpellcheck(!1),"selection"!==e.type)return s.error("UI.SelectionInput: not a selection",e),this;this.setValue(e.string),this.selection=e;var t=this;return e.signals.stringChanged.add((function(e){t.setValue(e)})),this.onEnter(),this},o.SelectionInput.prototype=Object.create(o.AdaptiveTextArea.prototype),o.SelectionInput.prototype.setValue=function(e){return o.AdaptiveTextArea.prototype.setValue.call(this,e),this},o.SelectionInput.prototype.onEnter=function(e){var t=this,n=function(e){return!new s.Selection(e).selection.error};return this.onKeyPress((function(i){var s=t.getValue(),o=String.fromCharCode(i.which);13===i.keyCode?(i.preventDefault(),n(s)?("function"==typeof e?e(s):t.selection.setString(s),t.setBackgroundColor("white")):t.setBackgroundColor("tomato")):t.selection.string!==s+o?t.setBackgroundColor("skyblue"):t.setBackgroundColor("white")})),this.onKeyUp((function(e){var i=t.getValue();n(i)?t.selection.string===t.getValue()?t.setBackgroundColor("white"):t.setBackgroundColor("skyblue"):t.setBackgroundColor("tomato")})),this},o.SelectionPanel=function(e){return o.Panel.call(this),this.icon=new o.Icon("filter").setTitle("filter selection").addClass("lg").setMarginRight("10px"),this.input=new o.SelectionInput(e),this.add(this.icon,this.input),this},o.SelectionPanel.prototype=Object.create(o.Panel.prototype),o.SelectionPanel.prototype.setInputWidth=function(e){return this.input.setWidth(e),this},o.ComponentPanel=function(e){o.Panel.call(this);var t=e.stage,n=e.signals;n.nameChanged.add((function(e){i.setValue(e)})),n.visibilityChanged.add((function(e){s.setValue(e)})),n.disposed.add((function(){l.dispose()}));var i=new o.EllipsisText(e.name).setWidth("100px"),s=new o.ToggleIcon(e.visible,"eye","eye-slash").setTitle("hide/show").setCursor("pointer").setMarginLeft("25px").onClick((function(){e.setVisibility(!e.visible)})),r=new o.Icon("bullseye").setTitle("center").setCursor("pointer").setMarginLeft("10px").onClick((function(){e.autoView(1e3)})),a=(new o.DisposeIcon).setMarginLeft("10px").setDisposeFunction((function(){t.removeComponent(e)})),l=new o.PopupMenu("bars",e.type).setMarginLeft("46px").setEntryLabelWidth("110px");return this.add(i,s,r,a,l),this.menu=l,this},o.ComponentPanel.prototype=Object.create(o.Panel.prototype),o.ComponentPanel.prototype.addMenuEntry=function(e,t){return this.menu.addEntry(e,t),this},o.ComponentPanel.prototype.setMenuDisplay=function(e){return this.menu.setMenuDisplay(e),this},e.exports={UI:o}},7387:function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,o){function r(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}l((i=i.apply(e,t||[])).next())}))},Jupyter;Object.defineProperty(exports,"__esModule",{value:!0}),exports.NGLView=exports.NGLModel=void 0;var widgets=__webpack_require__(7708),NGL=__webpack_require__(2280),BaseView=__webpack_require__(7410).BaseView;const $=__webpack_require__(2914),_=__webpack_require__(8731);__webpack_require__(6900),__webpack_require__(5435),__webpack_require__(7579),__webpack_require__(8490),__webpack_require__(5379),__webpack_require__(2466),__webpack_require__(6257);const gui_1=__webpack_require__(3620),fullscreen_1=__webpack_require__(9639),color_1=__webpack_require__(587),theme_1=__webpack_require__(5395);NGL.nglview_debug=!1;const chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),uuid=new Array(36);function generateUUID(){let e,t=0;for(let n=0;n<36;n++)8===n||13===n||18===n||23===n?uuid[n]="-":14===n?uuid[n]="4":(t<=2&&(t=33554432+16777216*Math.random()|0),e=15&t,t>>=4,uuid[n]=chars[19===n?3&e|8:e]);return uuid.join("")}function createView(e,t){return __awaiter(this,void 0,void 0,(function*(){console.log("Creating view for model "+t);var n=e.model.widget_manager,i=e.model.get(t).replace("IPY_MODEL_","");return yield n.create_view(yield n.get_model(i))}))}class NGLModel extends widgets.DOMWidgetModel{defaults(){return _.extend(widgets.DOMWidgetModel.prototype.defaults(),{_model_name:"NGLModel",_model_module:"nglview-js-widgets",_model_module_version:__webpack_require__(306).version,_view_name:"NGLView",_view_module:"nglview-js-widgets",_view_module_version:__webpack_require__(306).version})}}exports.NGLModel=NGLModel;class NGLView extends widgets.DOMWidgetView{render(){this.beforeDisplay(),this.displayed.then(function(){this.createStage(),this.handlePicking(),this.handleSignals(),this.handleMessage(),this.finalizeDisplay()}.bind(this))}beforeDisplay(){this.model.on("change:_parameters",this.parametersChanged,this),this.model.on("change:gui_style",this.GUIStyleChanged,this),this.model.set("_ngl_version",NGL.Version),this._ngl_focused=0,this.uuid=generateUUID(),this.stage_widget=void 0,this.comp_uuids=[],this._synced_model_ids=this.model.get("_synced_model_ids"),this._synced_repr_model_ids=this.model.get("_synced_repr_model_ids"),this.isEmbeded()&&this._handleEmbedBeforeStage()}createStage(){var e=this.model.get("_ngl_full_stage_parameters");"backgroundColor"in e||(e.backgroundColor="white"),NGL.useWorker=!1,this.options.parent,this.stage=new NGL.Stage(void 0),this.$container=$(this.stage.viewer.container),this.$el.append(this.$container),this.stage.setParameters(e),this.$container=$(this.stage.viewer.container),this.handleResizable(),this.ngl_view_id=this.uuid,this.touch();var t=this.model.get("_view_width")||this.$el.parent().width()+"px",n=this.model.get("_view_height")||"300px";this.setSize(t,n),this.createFullscreenBtn(),this.createIPlayer(),this.GUIStyleChanged(),this.$container.resizable("option","maxWidth",this.$el.parent().width()),this.isEmbeded()?(console.log("Embed mode for NGLView"),this.handleEmbed()):(this.requestUpdateStageParameters(),1==this.model.views.length?this.serialize_camera_orientation():this.set_camera_orientation(this.model.get("_camera_orientation")))}isEmbeded(){return this.model.get("_ngl_serialize")||null==this.model.comm}handleMessage(){this.model.on("msg:custom",(function(e){this.on_msg(e)}),this),this.model.comm&&this.model.comm.on_msg(function(e){var t=e.buffers,n=e.content.data.content;t.length&&n&&(n.buffers=t),this.model._handle_comm_msg.call(this.model,e)}.bind(this))}finalizeDisplay(){this.send({type:"request_loaded",data:!0});var e=this.stage.getParameters();this.model.set("_ngl_original_stage_parameters",e),this.touch(),!this.isEmbeded()&&this.stage.compList.length<this.model.get("n_components")&&this.handleEmbed();var t=this.model.get("_ngl_view_id");t.push(this.ngl_view_id),this.send({type:"updateIDs",data:t})}handleSignals(){var e=this.stage.viewer.container,t=this;e.addEventListener("mouseover",(function(e){t._ngl_focused=1,t.mouseOverDisplay("block")}),!1),e.addEventListener("mouseout",(function(e){t._ngl_focused=0,t.mouseOverDisplay("none")}),!1),e.addEventListener("contextmenu",(function(e){e.stopPropagation(),e.preventDefault()}),!0),this.stage.signals.componentAdded.add((function(e){this.comp_uuids.push(e.uuid);var n=this.stage.compList.length;this.model.set("n_components",n),this.touch();var i=this.stage.compList[n-1];i.signals.representationRemoved.add((function(){t.request_repr_dict()})),i.signals.representationAdded.add((function(e){t.request_repr_dict(),e.signals.parametersChanged.add((function(){console.log("repr.parametersChanged"),t.request_repr_dict()}))}))}),this),this.stage.signals.componentRemoved.add((function(e){return __awaiter(this,void 0,void 0,(function*(){var t=this.comp_uuids.indexOf(e.uuid);this.comp_uuids.splice(t,1);var n=this.stage.compList.length;this.model.set("n_components",n),this.touch(),console.log("componentRemoved",e,e.uuid);var i=[];for(var s in this.model.views)i.push(this.model.views[s]);var o=yield Promise.all(i);console.log(o);var r=!1;for(var s in o){var a=o[s];a.uuid!=this.uuid&&a.stage.compList.length>n&&(a.stage.removeComponent(a.stage.compList[t]),r=!0)}r&&(console.log("should update backend"),this.send({type:"removeComponent",data:t}))}))}),this),this.stage.signals.parametersChanged.add((function(){this.requestUpdateStageParameters()}),this),this.stage.viewerControls.signals.changed.add(function(){this.serialize_camera_orientation();var e=this.stage.viewerControls.getOrientation();t._synced_model_ids.length>0&&1==t._ngl_focused&&t._synced_model_ids.forEach((function(n){return __awaiter(this,void 0,void 0,(function*(){var i=yield t.model.widget_manager.get_model(n);for(var s in i.views){i.views[s];var o=yield i.views[s];o.uuid!=t.uuid&&o.stage.viewerControls.orient(e)}}))}))}.bind(this))}handlePicking(){this.$pickingInfo=$("<div></div>").css("position","absolute").css("top","5%").css("left","3%").css("background-color","white").css("padding","2px 5px 2px 5px").css("opacity","0.7").appendTo(this.$container),this.stage.signals.clicked.add((function(e){if(e){this.model.set("picked",{}),this.touch();var t={},n="";e.atom?(t.atom1=e.atom.toObject(),t.atom1.name=e.atom.qualifiedName(),n="Atom: "+t.atom1.name):e.bond&&(t.bond=e.bond.toObject(),t.atom1=e.bond.atom1.toObject(),t.atom1.name=e.bond.atom1.qualifiedName(),t.atom2=e.bond.atom2.toObject(),t.atom2.name=e.bond.atom2.qualifiedName(),n="Bond: "+t.atom1.name+" - "+t.atom2.name),e.instance&&(t.instance=e.instance);for(var i=this.stage.compList.length,s=0;s<i;s++)this.stage.compList[s].uuid==e.component.uuid&&(t.component=s);this.model.set("picked",t),this.touch(),this.$pickingInfo.text(n)}}),this)}mouseOverDisplay(e){return __awaiter(this,void 0,void 0,(function*(){var t=this;if(this.btn_pview_fullscreen){var n=yield this.btn_pview_fullscreen;n.el.style.display=e,t.stage_widget&&(n.el.style.display="none")}if(t=this,this.player_pview){var i=yield this.player_pview;i.el.style.display=e,t.model.get("max_frame")&&0!=t.model.get("max_frame")||(i.el.style.display="none")}}))}updateNGLTheme(e){var t=document.getElementById("nglview_style");null!=t&&document.head.removeChild(t);var n=document.createElement("style");n.id="nglview_style",n.type="text/css",n.appendChild(document.createTextNode(e)),document.head.appendChild(n)}serialize_camera_orientation(){var e=this.stage.viewerControls.getOrientation();this.model.set("_camera_orientation",e.elements),this.touch()}set_camera_orientation(e){e.length>0&&(this.stage.viewerControls.orient(e),this.serialize_camera_orientation())}executeCode(code){eval(code)}_handleEmbedBeforeStage(){var e,t=this.model.get("_ngl_color_dict");for(e in t)NGL.ColormakerRegistry.hasScheme(e)||this.addColorScheme(t[e],e)}handleEmbed(){return __awaiter(this,void 0,void 0,(function*(){var e=this,t=e.model.get("_ngl_msg_archive"),n=e.model.get("_ngl_full_stage_parameters"),i=[];if(_.each(t,(function(t){"loadFile"==t.methodName&&(t.kwargs&&t.kwargs.defaultRepresentation&&(t.kwargs.defaultRepresentation=!1),i.push(e._getLoadFilePromise(t)))})),yield Promise.all(i),e._set_representation_from_repr_dict(e.model.get("_ngl_repr_dict")),e.stage.setParameters(n),e.set_camera_orientation(e.model.get("_camera_orientation")),e.touch(),void 0===e.model.comm){var s=e.model.get("_ngl_coordinate_resource"),o=s.n_frames||1;e.model.set("max_frame",o-1),e.touch();var r=(yield e.getPlayerModel()).get("children")[0];e.listenTo(r,"change:value",(function(){e.updateCoordinatesFromDict(s,r.get("value"))}))}e.model.get("_ngl_msg_archive").forEach((function(t){t.fire_embed&&e.on_msg(t)})),e.handleResize()}))}updateCoordinatesFromDict(e,t){for(var n=Object.keys(e).filter((e=>"n_frames"!==e)),i=0;i<n.length;i++){var s=n[i],o=this.decode_base64(e[s][t]);o&&o.byteLength>0&&this.updateCoordinates(o,s)}}requestFrame(){this.send({type:"request_frame",data:"frame"})}requestUpdateStageParameters(){var e=this.stage.getParameters();this.model.set("_ngl_full_stage_parameters",e),this.touch()}requestReprParameters(e,t){var n=this.stage.compList[e].reprList[t],i=n.repr.getParameters();i&&(i.name=n.name,this.send({type:"repr_parameters",data:i}))}request_repr_dict(){var e=this.getReprDictFrontEnd();this.send({type:"request_repr_dict",data:e});var t=this;t._synced_repr_model_ids.length>0&&t._synced_repr_model_ids.forEach((function(n){return __awaiter(this,void 0,void 0,(function*(){var i=yield t.model.widget_manager.get_model(n);for(var s in i.views){var o=yield i.views[s];o.uuid!=t.uuid&&o._set_representation_from_repr_dict(e)}}))}))}getReprDictFrontEnd(){for(var e={},t=this.stage.compList.length,n=0;n<t;n++){var i=this.stage.compList[n];e[n]={};for(var s=e[n],o=0;o<i.reprList.length;o++){var r=i.reprList[o];s[o]={},s[o].type=r.name,s[o].params=r.repr.getParameters()}}return e}syncReprForAllViews(){var e=this.model.get("_ngl_repr_dict"),t=this.getReprDictFrontEnd();JSON.stringify(t)!==JSON.stringify(e)&&this._set_representation_from_repr_dict(e)}syncReprWithMe(){return __awaiter(this,void 0,void 0,(function*(){var e=this.getReprDictFrontEnd();for(var t in this.model.views){var n=yield this.model.views[t];n.uuid!=this.uuid&&n._set_representation_from_repr_dict(e)}this.request_repr_dict()}))}setSyncRepr(e){this._synced_repr_model_ids=e}setSyncCamera(e){this._synced_model_ids=e}viewXZPlane(){var e=(new NGL.Matrix4).makeRotationX(Math.PI/2),t=(new NGL.Quaternion).setFromRotationMatrix(e);this.stage.viewerControls.rotate(t)}set_representation_from_backend(){var e=this.model.get("_ngl_repr_dict");this._set_representation_from_repr_dict(e)}_set_representation_from_repr_dict(e){var t=this.stage.compList;if(t.length>0)for(var n in e){var i=t[n];i.removeAllRepresentations();var s=e[n];for(var o in s){var r=s[o];r&&i.addRepresentation(r.type,r.params)}}}createView(e){return __awaiter(this,void 0,void 0,(function*(){console.log("Creating view for model "+e);var t=this.model.widget_manager,n=this.model.get(e).replace("IPY_MODEL_","");return yield t.create_view(yield t.get_model(n))}))}getPlayerModel(){var e=this.model.get("_iplayer").replace("IPY_MODEL_","");return this.model.widget_manager.get_model(e)}createIPlayer(){return __awaiter(this,void 0,void 0,(function*(){this.player_pview=this.createView("_iplayer");var e=yield this.player_pview,t=e.el;t.style.position="absolute",t.style.zIndex=100,t.style.bottom="5%",t.style.left="10%",t.style.opacity="0.7",this.stage.viewer.container.append(e.el),t.style.display="none"}))}createImageBtn(){return __awaiter(this,void 0,void 0,(function*(){this.image_btn_pview=this.createView("_ibtn_image");var e=yield this.image_btn_pview,t=e.el;t.style.position="absolute",t.style.zIndex=100,t.style.top="5%",t.style.right="10%",t.style.opacity="0.7",t.style.width="35px",this.stage.viewer.container.append(e.el)}))}createFullscreenBtn(){return __awaiter(this,void 0,void 0,(function*(){this.btn_pview_fullscreen=this.createView("_ibtn_fullscreen");var e=yield this.btn_pview_fullscreen,t=this.stage,n=e.el;n.style.position="absolute",n.style.zIndex=100,n.style.top="5%",n.style.right="5%",n.style.opacity="0.7",n.style.width="35px",n.style.background="white",n.style.opacity="0.3",n.style.display="none",n.onclick=function(){this.stage.toggleFullscreen()}.bind(this),t.viewer.container.append(e.el),t.signals.fullscreenChanged.add((function(t){t?e.model.set("icon","compress"):e.model.set("icon","expand")}))}))}createGUI(){return __awaiter(this,void 0,void 0,(function*(){this.pgui_view=this.createView("_igui");var e=yield this.pgui_view,t=e.el;t.style.position="absolute",t.style.zIndex=100,t.style.top="5%",t.style.right="10%",t.style.width="300px",this.stage.viewer.container.append(e.el)}))}createNglGUI(){this.stage_widget=new gui_1.StageWidget(this)}setVisibilityForRepr(e,t,n){var i=this.stage.compList[e].reprList[t];i&&i.setVisibility(n)}removeRepresentation(e,t){var n=this.stage.compList[e],i=n.reprList[t];i&&n.removeRepresentation(i)}removeRepresentationsByName(e,t){var n=this.stage.compList[t];n&&n.reprList.forEach((function(t){t.name==e&&n.removeRepresentation(t)}))}updateRepresentationForComponent(e,t,n){var i=this.stage.compList[t].reprList[e];i&&i.setParameters(n)}updateRepresentationsByName(e,t,n){var i=this.stage.compList[t],s=this;i&&i.reprList.forEach((function(t){t.name==e&&(t.setParameters(n),s.request_repr_dict())}))}setRepresentation(e,t,n,i){var s=this.stage.compList[n],o=s.reprList[i];if(o){t.useWorker=!1;var r=NGL.makeRepresentation(e,s.structure,this.stage.viewer,t);r&&(o.setRepresentation(r),o.name=e,s.reprList[i]=o,this.request_repr_dict())}}setColorByResidue(e,t,n){var i=this.stage.compList[t].reprList[n],s=NGL.ColormakerRegistry.addScheme((function(t){this.atomColor=function(t){return e[t.residueIndex]}}));i.setColor(s)}addShape(e,t){for(var n=new NGL.Shape(e),i={sphere:n.addSphere,ellipsoid:n.addEllipsoid,cylinder:n.addCylinder,cone:n.addCone,mesh:n.addMesh,arrow:n.addArrow,text:n.addText,label:n.addText,tetrahedron:n.addTetrahedron,octahedron:n.addOctahedron,torus:n.addTorus},s=0;s<t.length;s++){var o=t[s],r=o[0],a=o.slice(1,o.length);i[r].apply(n,a)}this.stage.addComponentFromObject(n).addRepresentation("buffer")}addBuffer(e,t){var n={arrow:NGL.ArrowBuffer,box:NGL.BoXbuffer,cone:NGL.ConeBuffer,cylinder:NGL.CylinderBuffer,ellipsoid:NGL.EllipsoidBuffer,octahedron:NGL.OctahedronBuffer,sphere:NGL.SphereBuffer,text:NGL.TextBuffer,tetrahedron:NGL.TetrahedronBuffer,torus:NGL.TorusBuffer},i={};for(var s in t)i[s]=new Float32Array(t[s]);var o=new NGL.Shape("shape"),r=new(0,n[e])(i);o.addBuffer(r),this.stage.addComponentFromObject(o).addRepresentation("buffer")}replaceStructure(e){return __awaiter(this,void 0,void 0,(function*(){var t=new Blob([e.data],{type:"text/plain"}),n=this.stage,i=e.params||{};i.ext=e.ext,i.defaultRepresentation=!1;var s=this.stage.compList[0],o=s.reprList.slice(),r=this.stage.viewerControls.getOrientation(),a=yield this.stage.loadFile(t,i);n.viewerControls.orient(r),o.forEach((function(e){var t=e.name,n=e.repr.getParameters();a.addRepresentation(t,n)})),n.removeComponent(s),this._handleLoadFileFinished()}))}superpose(e,t,n,i,s){var o=this.stage.compList[e];this.stage.compList[t].superpose(o,n,i,s)}decode_base64(e){var t,n,i,s,o,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=.75*e.length,l=e.length,d=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var c=new ArrayBuffer(a),u=new Uint8Array(c);for(t=0;t<l;t+=4)n=r.indexOf(e[t]),i=r.indexOf(e[t+1]),s=r.indexOf(e[t+2]),o=r.indexOf(e[t+3]),u[d++]=n<<2|i>>4,u[d++]=(15&i)<<4|s>>2,u[d++]=(3&s)<<6|63&o;return c}updateCoordinates(e,t){var n=this.stage.compList[t];if(e&&n){var i=new Float32Array(e);n.structure.updatePosition(i),n.updateRepresentations({position:!0})}}handleResizable(){this.$container.resizable({resize:function(e,t){this.setSize(t.size.width+"px",t.size.height+"px")}.bind(this)})}handleResize(){var e=this.$el.width(),t=this.$el.height()+"px";this.stage_widget&&(e-=$(this.stage_widget.sidebar.dom).width()),e+="px",this.setSize(e,t)}setSize(e,t){this.stage.viewer.container.style.width=e,this.stage.viewer.container.style.height=t,this.stage.handleResize()}GUIStyleChanged(){if("ngl"===this.model.get("gui_style"))this.createNglGUI();else if(this.stage_widget){this.stage_widget.dispose(),this.stage_widget=void 0,this.$container.resizable("enable");var e=this.$el.parent().width()+"px",t=this.$el.parent().height()+"px";this.setSize(e,t)}}parametersChanged(){var e=this.model.get("_parameters");this.setParameters(e)}setParameters(e){this.stage.setParameters(e);var t=this.stage.getParameters();this.send({type:"stage_parameters",data:t})}_downloadImage(e,t){return __awaiter(this,void 0,void 0,(function*(){if(this.ngl_view_id==this.get_last_child_id()){var n=yield this.stage.makeImage(t);NGL.download(n,e)}}))}_exportImage(e,t){return __awaiter(this,void 0,void 0,(function*(){if(this.ngl_view_id==this.get_last_child_id()){var n,i=yield this.stage.makeImage(t),s=new FileReader;s.onload=function(){n=s.result.replace("data:image/png;base64,",""),this.send({data:n,type:"image_data",ID:e}),this.send({type:"async_message",data:"ok"})}.bind(this),s.readAsDataURL(i)}}))}handleMovieMaking(e){return __awaiter(this,void 0,void 0,(function*(){if(console.log("handleMovieMaking: render_params",e),this.ngl_view_id==this.get_last_child_id()){var t,n=yield this.stage.makeImage(e),i=new FileReader;i.onload=function(){t=i.result.replace("data:image/png;base64,",""),this.send({data:t,type:"movie_image_data"}),this.send({type:"async_message",data:"ok"})}.bind(this),i.readAsDataURL(n)}}))}_handleLoadFileFinished(){this.send({type:"async_message",data:"ok"})}_getLoadFilePromise(e){var t,n=e.args[0];if("blob"==n.type){var i;if(n.binary){var s=this.decode_base64(n.data);i=new Blob([s],{type:"application/octet-binary"})}else i=new Blob([n.data],{type:"text/plain"});return this.stage.loadFile(i,e.kwargs)}return new File([""],n.data),t=n.data,this.stage.loadFile(t,e.kwargs)}get_last_child_id(){var e=this.model.get("_ngl_view_id");return e[e.length-1]}_handleStageLoadFile(e){return __awaiter(this,void 0,void 0,(function*(){this.ngl_view_id!=this.get_last_child_id()&&e.last_child||(yield this._getLoadFilePromise(e),this._handleLoadFileFinished())}))}addColorScheme(e,t){var n=NGL.ColormakerRegistry.addSelectionScheme(e,t),i=NGL.ColormakerRegistry.userSchemes[n];return NGL.ColormakerRegistry.removeScheme(n),NGL.ColormakerRegistry.add(t,i),t}on_msg(e){if(!("ngl_view_id"in e)||e.ngl_view_id===this.ngl_view_id)if("call_method"==e.type){var t,n,i,s,o=e.args.slice();switch(o.push(e.kwargs),"addRepresentation"==e.methodName&&e.reconstruc_color_scheme&&(e.kwargs.color=this.addColorScheme(e.kwargs.color,e.kwargs.color_label)),"colorVolume"in e.kwargs&&(t=e.kwargs.colorVolume,e.kwargs.colorVolume=this.stage.compList[t].volume),e.target){case"Stage":var r=this.stage[e.methodName];s=this.stage,"screenshot"==e.methodName?NGL.screenshot(this.stage.viewer,e.kwargs):"removeComponent"==e.methodName?(t=e.args[0],n=this.stage.compList[t],this.stage.removeComponent(n)):"loadFile"==e.methodName?(this.model.views.length>1&&e.kwargs&&e.kwargs.defaultRepresentation&&(e.kwargs.defaultRepresentation=!1),this._handleStageLoadFile(e)):r.apply(s,o);break;case"Viewer":var a=this.stage.viewer;(i=this.stage.viewer[e.methodName]).apply(a,o);break;case"viewerControls":var l=this.stage.viewerControls;(i=l[e.methodName]).apply(l,o);break;case"compList":t=e.component_index,(i=(n=this.stage.compList[t])[e.methodName]).apply(n,o);break;case"Widget":(i=this[e.methodName])?i.apply(this,o):console.log("can not create func for "+e.methodName);break;case"Representation":var d=e.component_index,c=e.repr_index,u=(n=this.stage.compList[d]).reprList[c];i=u[e.methodName],u&&i&&i.apply(u,o);break;default:console.log("there is no method for "+e.target)}}else if("base64_single"==e.type)for(var p=e.data,h=Object.keys(p),m=0;m<h.length;m++){var g=h[m],f=this.decode_base64(p[g]);f&&f.byteLength>0&&this.updateCoordinates(f,g)}else if("binary_single"==e.type){var v=e.data;for(h=Object.keys(v),m=0;m<h.length;m++)g=h[m],(f=new Float32Array(e.buffers[m].buffer)).byteLength>0&&this.updateCoordinates(f,g);e.movie_making&&this.handleMovieMaking(e.render_params)}else"get"==e.type&&("camera"==e.data?this.send(JSON.stringify(this.stage.viewer.camera)):"parameters"==e.data?this.send(JSON.stringify(this.stage.parameters)):(console.log("Number of components",this.stage.compList.length),console.log("ngl_view_id",this.ngl_view_id)))}}exports.NGLView=NGLView,module.exports={NGLView,NGLModel,NGL,FullscreenModel:fullscreen_1.FullscreenModel,FullscreenView:fullscreen_1.FullscreenView,ColormakerRegistryModel:color_1.ColormakerRegistryModel,ColormakerRegistryView:color_1.ColormakerRegistryView,ThemeManagerModel:theme_1.ThemeManagerModel,ThemeManagerView:theme_1.ThemeManagerView}},306:e=>{"use strict";e.exports={version:"3.0.1"}}}]);